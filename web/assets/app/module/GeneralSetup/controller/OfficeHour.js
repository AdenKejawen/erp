Ext.define("GatotKacaErp.module.GeneralSetup.controller.OfficeHour",{extend:"GatotKacaErp.controller.Base",views:["GatotKacaErp.module.GeneralSetup.view.OfficeHour"],store:"GatotKacaErp.module.GeneralSetup.store.OfficeHour",fmSelector:"formofficehour",init:function(){var b=this;var a=b.getStore(b.store);a.addListener("load",b.onStoreLoad,b);b.loadStore(a);b.getStore("GatotKacaErp.store.Hour");b.getStore("GatotKacaErp.store.Minute");b.control({"formofficehour button[action=save]":{click:b.save},"formofficehour button[action=reset]":{click:b.resetForm},gridofficehour:{itemclick:b.viewDetail,itemcontextmenu:b.showContextMenu},"gridofficehour button[action=refresh]":{click:b.reloadStore},"gridofficehour textfield[action=search]":{keypress:b.search}});b.callParent(arguments)},save:function(b,a,e){var d=this;var c=b.up("form").getForm();if(c.isValid()){d.ajaxRequest(BASE_URL+"officehour/save",{officehour:Ext.JSON.encode(c.getValues())},function(f){d.showMessage({title:"SERVER MESSAGE",msg:f.msg,icon:Ext.MessageBox.INFO,buttons:Ext.MessageBox.OK});d.reloadStore();d.resetForm()})}else{d.showMessage({title:"ERROR MESSAGE",msg:"Form is not valid",icon:Ext.MessageBox.WARNING,buttons:Ext.MessageBox.OK})}},resetForm:function(){this.getForm(this.fmSelector).reset()},viewDetail:function(d,c,g,a,b,f){var e=this.getForm(this.fmSelector);this.ajaxRequest(BASE_URL+"officehour/getbyid",{officehour_id:c.data.officehour_id},function(h){e.setValues(h.data[0]);var j=h.data[0].officehour_in.split(":");var i=h.data[0].officehour_out.split(":");e.findField("officehour_hin").setValue(j[0]);e.findField("officehour_min").setValue(j[1]);e.findField("officehour_hout").setValue(i[0]);e.findField("officehour_mout").setValue(i[1])})},reloadStore:function(){this.loadStore(this.store)},search:function(d,a,c){var b=this;if(a.ENTER==a.getKey()){this.loadStore(b.store,{query:d.getValue()})}}});