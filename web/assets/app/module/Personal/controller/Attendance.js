Ext.define("GatotKacaErp.module.Personal.controller.Attendance",{extend:"GatotKacaErp.controller.Base",views:["GatotKacaErp.module.Personal.view.Attendance"],store:"GatotKacaErp.module.Personal.store.Attendance",startDate:"attPersonalFilterFrom",endDate:"attPersonalFilterTo",init:function(){var b=this;var a=b.getStore(b.store);a.addListener("load",b.onStoreLoad,b);b.loadStore(a);b.control({"gridprattendance datefield[name=attPersonalFilterFrom]":{change:b.filter},"gridprattendance datefield[name=attPersonalFilterTo]":{change:b.filter},"gridprattendance button[action=preview]":{click:b.preview},"gridprattendance button[action=pdf]":{click:b.exportPDF},"gridprattendance button[action=xls]":{click:b.exportXLS},"gridprattendance button[action=image]":{click:b.exportJPG}});b.callParent(arguments)},preview:function(b,a,d){var c=this;c.exportValid(function(f,e){c.ajaxRequest(BASE_URL+"human_resources/attendance/preview",{from:f,to:e},function(g){c.showWindow({html:g.data},"Print Preview","70%","90%","icon-page_white_magnify")})})},exportPDF:function(b,a,c){this.exportValid(function(e,d){window.open(BASE_URL+"human_resources/attendance/export/pdf/"+e+"/"+d)})},exportXLS:function(b,a,c){this.exportValid(function(e,d){window.open(BASE_URL+"human_resources/attendance/export/excel/"+e+"/"+d)})},exportJPG:function(b,a,c){this.exportValid(function(e,d){window.open(BASE_URL+"human_resources/attendance/export/jpg/"+e+"/"+d)})},filter:function(b,a,d){var c=this;var f=Ext.Date.format(Ext.getCmp(c.startDate).getValue(),"Y-m-d");var e=Ext.Date.format(Ext.getCmp(c.endDate).getValue(),"Y-m-d");if(f!=""&&e!=""){this.loadStore(c.store,{from:f,to:e})}},exportValid:function(e){var b=this;var d=Ext.Date.format(Ext.getCmp(b.startDate).getValue(),"Y-m-d");var c=Ext.Date.format(Ext.getCmp(b.endDate).getValue(),"Y-m-d");if(d==""){var a=new Date();d=new Date(a.getFullYear(),a.getMonth(),1);c=new Date(a.getFullYear(),a.getMonth()+1,0)}if(e&&typeof(e)==="function"){e(d,c)}}});