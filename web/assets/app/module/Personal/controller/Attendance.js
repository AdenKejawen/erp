Ext.define("Com.GatotKaca.ERP.module.Personal.controller.Attendance",{extend:"Com.GatotKaca.ERP.controller.Base",views:["Com.GatotKaca.ERP.module.Personal.view.Attendance"],store:"Com.GatotKaca.ERP.module.Personal.store.Attendance",startDate:"attPersonalFilterFrom",endDate:"attPersonalFilterTo",init:function(){var b=this;var a=b.getStore(b.store);a.addListener("load",b.onStoreLoad,b);b.loadStore(a);b.control({"gridprattendance datefield[name=attPersonalFilterFrom]":{change:b.filter},"gridprattendance datefield[name=attPersonalFilterTo]":{change:b.filter},"gridprattendance button[action=preview]":{click:b.preview},"gridprattendance button[action=pdf]":{click:b.exportPDF},"gridprattendance button[action=xls]":{click:b.exportXLS},"gridprattendance button[action=image]":{click:b.exportJPG}});b.callParent(arguments)},preview:function(b,a,d){var c=this;c.exportValid(function(f,e){c.ajaxRequest(BASE_URL+"human_resources/attendance/preview",{from:f,to:e},function(g){c.showWindow({html:g.data},"Print Preview","70%","90%","icon-page_white_magnify")})})},exportPDF:function(b,a,c){this.exportValid(function(e,d){window.open(BASE_URL+"human_resources/attendance/export/pdf/"+e+"/"+d)})},exportXLS:function(b,a,c){this.exportValid(function(e,d){window.open(BASE_URL+"human_resources/attendance/export/excel/"+e+"/"+d)})},exportJPG:function(b,a,c){this.exportValid(function(e,d){window.open(BASE_URL+"human_resources/attendance/export/jpg/"+e+"/"+d)})},filter:function(b,a,d){var c=this;var f=Ext.Date.format(Ext.getCmp(c.startDate).getValue(),DATE_FORMAT);var e=Ext.Date.format(Ext.getCmp(c.endDate).getValue(),DATE_FORMAT);if(f!=""&&e!=""){c.loadStore(c.store,{from:f,to:e})}},exportValid:function(d){var a=this;var c=Ext.Date.format(Ext.getCmp(a.startDate).getValue(),DATE_FORMAT);var b=Ext.Date.format(Ext.getCmp(a.endDate).getValue(),DATE_FORMAT);if(c==""){c=FILTER_START;b=FILTER_END}if(d&&typeof(d)==="function"){d(c,b)}}});