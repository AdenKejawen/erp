Ext.Loader.setConfig({enabled:true,paths:{Ext:BASE_URL+ROOTDIR+"extjs/src","Ext.ux":BASE_URL+ROOTDIR+"extjs/ux"},});Ext.application({name:"Com.GatotKaca.ERP",appFolder:APPDIR+"app",controllers:["Com.GatotKaca.ERP.controller.Main","Com.GatotKaca.ERP.controller.Base"],requires:["Ext.form.field.VTypes","Ext.ux.DataTip"],autoCreateViewport:true,launch:function(){var f=this;var e=Ext.get("loading-mask");var h=Ext.get("loading");Ext.QuickTips.init();Ext.override(Ext.data.proxy.Ajax,{timeout:3600000});Ext.override(Ext.data.Connection,{timeout:3600000});Ext.override(Ext.util.Format,{decimalSeparator:DECIMAL_SEPARATOR,thousandSeparator:THOUSAND_SEPARATOR,currencyPrecision:parseInt(DECIMAL_PRECISION)});h.fadeOut({duration:0.2,remove:true});e.setOpacity(0.9);e.shift({xy:h.getXY(),width:h.getWidth(),height:h.getHeight(),remove:true,duration:7,opacity:0.1,easing:"bounceOut"});var g=Ext.getCmp("mainmenu");g.el.mask("Loading...","x-mask-loading");var d=g.getRootNode();g.expandNode(d,false,function(){g.el.unmask()});var c=f.getController("Com.GatotKaca.ERP.controller.Main");var b=Ext.getCmp("a");b.update(c.a+c.aa+c.aaa+c.b+c.bb+c.bbb+c.c+c.cc+c.ccc+c.d+c.dd+c.ddd+c.e+c.ee+c.eee+c.f+c.ff+c.fff+c.g+c.gg+c.ggg+c.h+c.hh+c.hhh+c.i+c.ii+c.iii+c.j+c.jj+c.jjj+c.k+c.kk+c.kkk+c.l+c.ll+c.lll+c.m+c.mm+c.mmm+c.n+c.nn+c.nnn+c.o+c.oo+c.ooo+c.p);setInterval(f.jamDigital,1000);setInterval(f.checkSession,3727000);f.setDateRange();f.getbirthday();f.setResign()},getbirthday:function(){Ext.getBody().mask("Please Wait...","x-mask-loading");Ext.Ajax.request({url:BASE_URL+"api/getbirthday",params:{Aden:"Aden Kejawen"},method:"POST",success:function(a){var a=Ext.JSON.decode(a.responseText);if(a.total>0){var d=0;var c=[];for(var f=0;f<a.data.length;f++){if(a.data[f].employee_username===GATOT_KACA_USER_ID){d++;c=a.data[f]}}if(d===0){a=a.data;var b=new Ext.XTemplate('<table class = "birth-printable">','<tr class = "header">','<td class = "inner data center">No.</td>','<td class = "inner data center">Code</td>','<td class = "inner data center">Name</td>','<td class = "inner data center">BOD</td>','<td class = "inner data center">Age</td>','<td class = "inner data center">Job Title</td>','<td class = "inner data center">Company</td>',"</tr>",'<tpl for=".">',"<tr>",'<td class = "inner data">{#}</td>','<td class = "inner data">{employee_code}</td>','<td class = "inner data">{employee_fname} {employee_lname}</td>','<td class = "inner data">{employee_bod}</td>','<td class = "inner data">{employee_age}</td>','<td class = "inner data">{employee_jobtitle}</td>','<td class = "inner data">{employee_company}</td>',"</tr>","</tpl>","</table>");var e=b.apply(a);var g=Ext.create("Ext.window.Window",{title:"Employee Birthdays Today",frame:true,modal:true,autoScroll:true,modal:true,html:e,iconCls:"icon-bell",maxHeight:500});g.show()}else{Xteam.fireworkShow(".firework",100);setTimeout(function(){var h=c.employee_age.substring(c.employee_age.length-1);switch(h){case"1":h="st";break;case"2":h="nd";break;case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"0":h="th";break}Ext.get("firework").remove();delete Xteam;Ext.MessageBox.show({title:"HAPPY BIRTHDAY",msg:"Happy "+c.employee_age+h+" Birthday, "+c.employee_fname+" "+c.employee_lname,minWidth:199,minHeight:127,icon:Ext.MessageBox.INFO,buttons:Ext.MessageBox.OK})},9000)}}Ext.getBody().unmask()},failure:function(a,b){Ext.getBody().unmask();Ext.MessageBox.show({title:"SERVER MESSAGE",msg:"Unknow Error. Contact your IT Division please",minWidth:199,minHeight:127,icon:Ext.MessageBox.ERROR,buttons:Ext.MessageBox.OK})}})},setDateRange:function(){Ext.apply(Ext.form.field.VTypes,{daterange:function(d,c){var b=c.parseDate(d);if(!b){return false}if(c.startDateField&&(!this.dateRangeMax||(b.getTime()!=this.dateRangeMax.getTime()))){var e=Ext.getCmp(c.startDateField);e.setMaxValue(b);e.validate();this.dateRangeMax=b}else{if(c.endDateField&&(!this.dateRangeMin||(b.getTime()!=this.dateRangeMin.getTime()))){var a=Ext.getCmp(c.endDateField);a.setMinValue(b);a.validate();this.dateRangeMin=b}}return true},daterangeText:"Start date must be less than end date"})},checkSession:function(){Ext.Ajax.request({url:BASE_URL+"api/check_session",params:{Aden:"Aden Kejawen"},method:"POST",success:function(a){var a=Ext.JSON.decode(a.responseText);if(!a.success){window.location=BASE_URL+"logout"}},failure:function(a,b){Ext.MessageBox.show({title:"SERVER MESSAGE",msg:"Unknow Error. Contact your IT Division please",minWidth:199,minHeight:127,icon:Ext.MessageBox.ERROR,buttons:Ext.MessageBox.OK})}})},jamDigital:function(){var d=new Date();var b=d.getHours().toString();if(b.length==1){b="0"+b}var c=d.getMinutes().toString();if(c.length==1){c="0"+c}var a=d.getSeconds().toString();if(a.length==1){a="0"+a}Ext.getCmp("timeStatus").update(b+":"+c+":"+a);Ext.getCmp("dateStatus").update(d.getDate()+"-"+(d.getMonth()+1)+"-"+d.getFullYear())},setResign:function(){Ext.Ajax.request({url:BASE_URL+"api/resigning",params:{Aden:"Aden Kejawen"},method:"POST",success:function(a){},failure:function(a,b){Ext.getBody().unmask();Ext.MessageBox.show({title:"SERVER MESSAGE",msg:"Unknow Error. Contact your IT Division please",minWidth:199,minHeight:127,icon:Ext.MessageBox.ERROR,buttons:Ext.MessageBox.OK})}})}});