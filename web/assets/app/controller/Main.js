Ext.define("GatotKacaErp.controller.Main",{extend:"Ext.app.Controller",init:function(){var a=this;a.getStore("GatotKacaErp.store.TreeStore");a.control({mainmenu:{itemclick:a.onMenuClick},"mainmenu button[action=refresh]":{click:a.reloadMenu},"viewport #user":{click:a.viewProfile}});a.callParent(arguments)},onMenuClick:function(j,d,l,f,g,h){var i=this;var b=Ext.getCmp("mainTab");if(d.data.cls!="root"){var a=d.data.cls.replace(/_/g,".");var c=a.replace(/view/,"controller");var k=a.replace(/view/,"store");i.loadModule(b,k,a,c,d.data.iconCls,d.data.text,d.data.selector)}},reloadMenu:function(){Ext.getBody().mask("Loading Menu...","x-mask-loading");this.getStore("GatotKacaErp.store.TreeStore").load({callback:function(){Ext.getBody().unmask()}})},viewProfile:function(){this.loadModule(Ext.getCmp("mainTab"),"GatotKacaErp.module.Personal.store.Profile","GatotKacaErp.module.Personal.view.Profile","GatotKacaErp.module.Personal.controller.Profile","icon-user_magnify","PROFILE","personalprofile")},loadModule:function(a,h,g,c,f,i,b){var d=this;Ext.getBody().mask("Loading Module...","x-mask-loading");if(a.getChildByElement(b)===null){var e=Ext.getCmp(b);if(e!==undefined){e.destroy();d.getStore(h).load()}Ext.syncRequire(g,function(){d.getController(c);var j=Ext.create(g,{iconCls:f,title:i,id:b,alias:"widget."+b});a.add(j);a.setActiveTab(j)})}else{d.getStore(h).load();a.setActiveTab(b)}Ext.getBody().unmask()}});