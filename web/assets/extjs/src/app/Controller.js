Ext.define("Ext.app.Controller",{requires:["Ext.app.EventBus"],uses:["Ext.ModelManager","Ext.data.StoreManager","Ext.ComponentManager"],mixins:{observable:"Ext.util.Observable"},statics:{strings:{model:{getter:"getModel",upper:"Model"},view:{getter:"getView",upper:"View"},controller:{getter:"getController",upper:"Controller"},store:{getter:"getStore",upper:"Store"}},controllerRegex:/^(.*)\.controller\./,createGetter:function(a,b){return function(){return this[a](b)}},getGetterName:function(c,a){var d="get",e=c.split("."),f=e.length,b;for(b=0;b<f;b++){d+=Ext.String.capitalize(e[b])}d+=a;return d},processDependencies:function(n,p,c,d,g){if(!g||!g.length){return}var h=this,m=h.strings[d],b,l,k,a,e,f,i;for(e=0,f=g.length;e<f;e++){a=g[e];b=h.getFullName(a,d,c);l=b.absoluteName;k=b.shortName;p.push(l);i=h.getGetterName(k,m.upper);n[i]=h.createGetter(m.getter,a);if(d!=="controller"){n[i].$ext_getter=true}}},getFullName:function(c,e,d){var a=c,b,f;if((b=c.indexOf("@"))>0){a=c.substring(0,b);f=c.substring(b+1)+"."+a}else{if(c.indexOf(".")>0&&(Ext.ClassManager.isCreated(c)||Ext.Loader.isAClassNameWithAKnownPrefix(c))){f=c}else{if(!d){Ext.log.warn("Cannot find namespace for "+e+" "+c+", assuming it is fully qualified class name")}if(d){f=d+"."+e+"."+c;a=c}else{f=c}}}return{absoluteName:f,shortName:a}}},onClassExtended:function(b,c,a){var d=a.onBeforeCreated;a.onBeforeCreated=function(l,g){var f=Ext.app.Controller,j=f.controllerRegex,m=[],k,e,m,i,h;i=l.prototype;k=Ext.getClassName(l);e=g.$namespace||Ext.app.getNamespace(k)||((h=j.exec(k))&&h[1]);if(e){i.$namespace=e}else{Ext.log.warn("Missing namespace for "+k+", please define it in namespaces property of your Application class.")}f.processDependencies(i,m,e,"model",g.models);f.processDependencies(i,m,e,"view",g.views);f.processDependencies(i,m,e,"store",g.stores);f.processDependencies(i,m,e,"controller",g.controllers);Ext.require(m,Ext.Function.pass(d,arguments,this))}},constructor:function(a){var c=this,d,b;c.mixins.observable.constructor.call(c,a);Ext.apply(c,a);if(c.refs){c.ref(c.refs)}c.initEventBus();c.initAutoGetters()},initEventBus:function(){this.eventbus=Ext.app.EventBus.instance},initAutoGetters:function(){var b=this.self.prototype,c,a;for(c in b){a=b[c];if(Ext.isFunction(a)&&a.$ext_getter){a.call(this)}}},doInit:function(b){var a=this;if(!a._initialized){a.init(b);a._initialized=true}},init:Ext.emptyFn,onLaunch:Ext.emptyFn,ref:function(a){var f=this,b=0,e=a.length,g,d,c;a=Ext.Array.from(a);f.references=f.references||[];for(;b<e;b++){g=a[b];d=g.ref;c="get"+Ext.String.capitalize(d);if(!f[c]){f[c]=Ext.Function.pass(f.getRef,[d,g],f)}f.references.push(d.toLowerCase())}},addRef:function(a){return this.ref([a])},getRef:function(d,e,a){this.refCache=this.refCache||{};e=e||{};a=a||{};Ext.apply(e,a);if(e.forceCreate){return Ext.ComponentManager.create(e,"component")}var c=this,b=c.refCache[d];if(!b){c.refCache[d]=b=Ext.ComponentQuery.query(e.selector)[0];if(!b&&e.autoCreate){c.refCache[d]=b=Ext.ComponentManager.create(e,"component")}if(b){b.on("beforedestroy",function(){c.refCache[d]=null})}}return b},hasRef:function(b){var a=this.references;return a&&Ext.Array.indexOf(a,b.toLowerCase())!==-1},control:function(b,c,a){this.eventbus.control(b,c,a||this)},getController:function(b){var a=this;if(b===a.id){return a}else{if(a.application){return a.application.getController(b)}else{return}}},getStore:function(c){var a,b;a=(c.indexOf("@")==-1)?c:c.split("@")[0];b=Ext.StoreManager.get(a);if(!b){c=Ext.app.Controller.getFullName(c,"store",this.$namespace);if(c){b=Ext.create(c.absoluteName,{storeId:a})}}return b},getModel:function(b){var a=Ext.app.Controller.getFullName(b,"model",this.$namespace);return a&&Ext.ModelManager.getModel(a.absoluteName)},getView:function(a){var b=Ext.app.Controller.getFullName(a,"view",this.$namespace);return b&&Ext.ClassManager.get(b.absoluteName)},getApplication:function(){return this.application}});