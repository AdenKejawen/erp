Ext.dom.AbstractElement.override({getAnchorXY:function(f,j,m){f=(f||"tl").toLowerCase();m=m||{};var i=this,a=i.dom==document.body||i.dom==document,b=m.width||a?window.innerWidth:i.getWidth(),k=m.height||a?window.innerHeight:i.getHeight(),l,c=Math.round,d=i.getXY(),h=a?0:!j?d[0]:0,g=a?0:!j?d[1]:0,e={c:[c(b*0.5),c(k*0.5)],t:[c(b*0.5),0],l:[0,c(k*0.5)],r:[b,c(k*0.5)],b:[c(b*0.5),k],tl:[0,0],bl:[0,k],br:[b,k],tr:[b,0]};l=e[f];return[l[0]+h,l[1]+g]},alignToRe:/^([a-z]+)-([a-z]+)(\?)?$/,getAlignToXY:function(e,w,h,r){r=!!r;e=Ext.get(e);if(!e||!e.dom){throw new Error("Element.alignToXY with an element that doesn't exist")}h=h||[0,0];if(!w||w=="?"){w="tl-bl?"}else{if(!(/-/).test(w)&&w!==""){w="tl-"+w}}w=w.toLowerCase();var u=this,d=w.match(this.alignToRe),m=window.innerWidth,t=window.innerHeight,c="",b="",z,v,l,k,p,n,f,a,j,i,q,o,g,s;if(!d){throw"Element.alignTo with an invalid alignment "+w}c=d[1];b=d[2];s=!!d[3];z=u.getAnchorXY(c,true);v=e.getAnchorXY(b,r);l=v[0]-z[0]+h[0];k=v[1]-z[1]+h[1];if(s){q=u.getWidth();o=u.getHeight();g=e.getPageBox();a=c.charAt(0);f=c.charAt(c.length-1);i=b.charAt(0);j=b.charAt(b.length-1);n=((a=="t"&&i=="b")||(a=="b"&&i=="t"));p=((f=="r"&&j=="l")||(f=="l"&&j=="r"));if(l+q>m){l=p?g.left-q:m-q}if(l<0){l=p?g.right:0}if(k+o>t){k=n?g.top-o:t-o}if(k<0){k=n?g.bottom:0}}return[l,k]},getAnchor:function(){var b=(this.$cache||this.getCache()).data,a;if(!this.dom){return}a=b._anchor;if(!a){a=b._anchor={}}return a},adjustForConstraints:function(c,b){var a=this.getConstrainVector(b,c);if(a){c[0]+=a[0];c[1]+=a[1]}return c}});