Ext.define("Ext.data.writer.Writer",{alias:"writer.base",alternateClassName:["Ext.data.DataWriter","Ext.data.Writer"],writeAllFields:true,nameProperty:"name",writeRecordId:true,isWriter:true,constructor:function(a){Ext.apply(this,a)},write:function(e){var c=e.operation,b=c.records||[],a=b.length,d=0,f=[];for(;d<a;d++){f.push(this.getRecordData(b[d],c))}return this.writeRecords(e,f)},getRecordData:function(d,b){var m=d.phantom===true,a=this.writeAllFields||m,g=d.fields,o=g.items,c={},k=d.clientIdProperty,j,i,n,l,e,h,p;if(a){p=o.length;for(h=0;h<p;h++){i=o[h];if(i.persist){this.writeValue(c,i,d)}}}else{j=d.getChanges();for(n in j){if(j.hasOwnProperty(n)){i=g.get(n);if(i.persist){this.writeValue(c,i,d)}}}}if(m){if(k&&b&&b.records.length>1){c[k]=d.internalId}}else{if(this.writeRecordId){e=g.get(d.idProperty)[this.nameProperty]||d.idProperty;c[e]=d.getId()}}return c},writeValue:function(e,f,b){var c=f[this.nameProperty]||f.name,a=this.dateFormat||f.dateWriteFormat||f.dateFormat,d=b.get(f.name);if(f.serialize){e[c]=f.serialize(d,b)}else{if(f.type===Ext.data.Types.DATE&&a&&Ext.isDate(d)){e[c]=Ext.Date.format(d,a)}else{e[c]=d}}}});