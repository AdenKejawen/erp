Ext.define("Ext.data.NodeInterface",{requires:["Ext.data.Field"],statics:{decorate:function(b){var a,c,d;if(typeof b=="string"){b=Ext.ModelManager.getModel(b)}else{if(b.isModel){b=Ext.ModelManager.getModel(b.modelName)}}if(b.prototype.isNode){return}a=b.prototype.idProperty;c=b.prototype.fields.get(a);d=b.prototype.fields.get(a).type.type;b.override(this.getPrototypeBody());this.applyFields(b,[{name:"parentId",type:d,defaultValue:null,useNull:c.useNull},{name:"index",type:"int",defaultValue:null,persist:false},{name:"depth",type:"int",defaultValue:0,persist:false},{name:"expanded",type:"bool",defaultValue:false,persist:false},{name:"expandable",type:"bool",defaultValue:true,persist:false},{name:"checked",type:"auto",defaultValue:null,persist:false},{name:"leaf",type:"bool",defaultValue:false},{name:"cls",type:"string",defaultValue:null,persist:false},{name:"iconCls",type:"string",defaultValue:null,persist:false},{name:"icon",type:"string",defaultValue:null,persist:false},{name:"root",type:"boolean",defaultValue:false,persist:false},{name:"isLast",type:"boolean",defaultValue:false,persist:false},{name:"isFirst",type:"boolean",defaultValue:false,persist:false},{name:"allowDrop",type:"boolean",defaultValue:true,persist:false},{name:"allowDrag",type:"boolean",defaultValue:true,persist:false},{name:"loaded",type:"boolean",defaultValue:false,persist:false},{name:"loading",type:"boolean",defaultValue:false,persist:false},{name:"href",type:"string",defaultValue:null,persist:false},{name:"hrefTarget",type:"string",defaultValue:null,persist:false},{name:"qtip",type:"string",defaultValue:null,persist:false},{name:"qtitle",type:"string",defaultValue:null,persist:false},{name:"qshowDelay",type:"int",defaultValue:null,persist:false},{name:"children",type:"auto",defaultValue:null,persist:false}])},applyFields:function(c,b){var g=c.prototype,a=g.fields,f=a.keys,e=b.length,h,d;for(d=0;d<e;d++){h=b[d];if(!Ext.Array.contains(f,h.name)){a.add(new Ext.data.Field(h))}}},getPrototypeBody:function(){return{isNode:true,constructor:function(){var a=this;this.callParent(arguments);Ext.applyIf(a,{firstChild:null,lastChild:null,parentNode:null,previousSibling:null,nextSibling:null,childNodes:[]});a.enableBubble(["append","remove","move","insert","beforeappend","beforeremove","beforemove","beforeinsert","expand","collapse","beforeexpand","beforecollapse","sort"]);return a},createNode:function(a){if(Ext.isObject(a)&&!a.isModel){a=Ext.ModelManager.create(a,this.modelName)}if(!a.childNodes){Ext.applyIf(a,{firstChild:null,lastChild:null,parentNode:null,previousSibling:null,nextSibling:null,childNodes:[]})}return a},isLeaf:function(){return this.get("leaf")===true},setFirstChild:function(a){this.firstChild=a},setLastChild:function(a){this.lastChild=a},updateInfo:function(f){var l=this,b=l.isRoot(),j=l.parentNode,d=(!j||b?true:j.firstChild===l),h=(!j||b?true:j.lastChild===l),g=0,m=l,a=l.childNodes,k=a.length,e=0,c=l.phantom;while(m.parentNode){++g;m=m.parentNode}l.beginEdit();l.set({isFirst:d,isLast:h,depth:g,index:j?j.indexOf(l):0,parentId:j?j.getId():null});l.endEdit(true);if(f){l.commit();l.phantom=c}for(e=0;e<k;e++){a[e].updateInfo(f)}},isLast:function(){return this.get("isLast")},isFirst:function(){return this.get("isFirst")},hasChildNodes:function(){return !this.isLeaf()&&this.childNodes.length>0},isExpandable:function(){var a=this;if(a.get("expandable")){return !(a.isLeaf()||(a.isLoaded()&&!a.hasChildNodes()))}return false},triggerUIUpdate:function(){this.afterEdit([])},appendChild:function(b,j,c){var g=this,d,f,e,h,a;if(Ext.isArray(b)){g.callStore("suspendAutoSync");for(d=0,f=b.length-1;d<f;d++){g.appendChild(b[d])}g.callStore("resumeAutoSync");g.appendChild(b[f])}else{b=g.createNode(b);if(j!==true&&(!g.hasListeners.beforeappend||g.fireEvent("beforeappend",g,b)===false)){return false}e=g.childNodes.length;h=b.parentNode;if(h){if(j!==true&&(!g.hasListeners.beforeremove||b.fireEvent("beforemove",b,h,g,e)===false)){return false}h.removeChild(b,false,false,true)}e=g.childNodes.length;if(e===0){g.setFirstChild(b)}g.childNodes.push(b);b.parentNode=g;b.nextSibling=null;g.setLastChild(b);a=g.childNodes[e-1];if(a){b.previousSibling=a;a.nextSibling=b;a.updateInfo(c)}else{b.previousSibling=null}b.updateInfo(c);if(!g.isLoaded()){g.set("loaded",true)}else{if(g.childNodes.length===1){g.triggerUIUpdate()}}if(!b.isLeaf()&&b.phantom){b.set("loaded",true)}if(j!==true){g.fireEvent("append",g,b,e);if(h){b.fireEvent("move",b,h,g,e)}}return b}},getBubbleTarget:function(){return this.parentNode},getOwnerTree:function(){var b=this,a;while(b.parentNode){b=b.parentNode}a=b.store;if(a){if(a.treeStore){a=a.treeStore}if(a.tree){return a.ownerTree}}return undefined},removeChild:function(h,e,f,b){var g=this,c=g.indexOf(h),d,a;if(c==-1||(f!==true&&(!g.hasListeners.beforeremove||g.fireEvent("beforeremove",g,h,!!b)===false))){return false}Ext.Array.erase(g.childNodes,c,1);if(g.firstChild==h){g.setFirstChild(h.nextSibling)}if(g.lastChild==h){g.setLastChild(h.previousSibling)}if(h.previousSibling){h.previousSibling.nextSibling=h.nextSibling}if(h.nextSibling){h.nextSibling.previousSibling=h.previousSibling}h.nextSibling=h.previousSibling=null;for(d=c>0?c-1:0,a=g.childNodes.length;d<a;d++){g.childNodes[d].updateInfo()}if(!g.childNodes.length){g.triggerUIUpdate()}if(f!==true){if(g.hasListeners.remove){g.fireEvent("remove",g,h,!!b)}}if(e){h.destroy(true)}else{h.clear()}return h},copy:function(d,c){var f=this,b=f.callParent(arguments),a=f.childNodes?f.childNodes.length:0,e;if(c){for(e=0;e<a;e++){b.appendChild(f.childNodes[e].copy(undefined,true))}}return b},clear:function(a){var b=this;b.parentNode=b.previousSibling=b.nextSibling=null;if(a){b.firstChild=b.lastChild=null}},destroy:function(b){var d=this,c=d.destroyOptions,a=d.childNodes,e=a.length,f;if(b===true){d.clear(true);for(f=0;f<e;f++){a[f].destroy(true)}d.childNodes=null;delete d.destroyOptions;d.callParent([c])}else{d.destroyOptions=b;d.remove(true)}},insertBefore:function(b,f,k){var g=this,e=g.indexOf(f),h=b.parentNode,j=e,c,a,d;if(!f){return g.appendChild(b)}if(b==f){return false}b=g.createNode(b);if(k!==true&&(!g.hasListeners.beforeinsert||g.fireEvent("beforeinsert",g,b,f)===false)){return false}if(h==g&&g.indexOf(b)<e){j--}if(h){if(k!==true&&(!g.hasListeners.beforeremove||b.fireEvent("beforemove",b,h,g,e,f)===false)){return false}h.removeChild(b,false,false,true)}if(j===0){g.setFirstChild(b)}Ext.Array.splice(g.childNodes,j,0,b);b.parentNode=g;b.nextSibling=f;f.previousSibling=b;a=g.childNodes[j-1];if(a){b.previousSibling=a;a.nextSibling=b}else{b.previousSibling=null}for(d=j>0?j-1:0,c=g.childNodes.length;d<c;d++){g.childNodes[d].updateInfo()}if(!g.isLoaded()){g.set("loaded",true)}else{if(g.childNodes.length===1){g.triggerUIUpdate()}}if(!b.isLeaf()&&b.phantom){b.set("loaded",true)}if(k!==true){if(g.hasListeners.insert){g.fireEvent("insert",g,b,f)}if(h&&g.hasListeners.move){b.fireEvent("move",b,h,g,j,f)}}return b},insertChild:function(a,c){var b=this.childNodes[a];if(b){return this.insertBefore(c,b)}else{return this.appendChild(c)}},remove:function(b,c){var d=this,a=d.parentNode;if(a){a.removeChild(d,b,c)}else{if(b){d.destroy(true)}}return d},removeAll:function(g,j,c){var f=this,h=this.childNodes,d=0,e=h.length,a,b;c=c===true;if(!c){a=f.store&&f.store.treeStore;if(a){a.beginBulkRemove()}}for(;d<e;++d){b=h[d];b.previousSibling=b.nextSibling=b.parentNode=null;f.fireEvent("remove",f,b,false);if(g){b.destroy(true)}else{b.removeAll(false,j,true)}}f.firstChild=f.lastChild=null;if(c){f.childNodes=null}else{f.childNodes.length=0}if(!c){f.triggerUIUpdate();if(a){a.endBulkRemove()}}return f},getChildAt:function(a){return this.childNodes[a]},replaceChild:function(a,d,c){var b=d?d.nextSibling:null;this.removeChild(d,false,c);this.insertBefore(a,b,c);return d},indexOf:function(a){return Ext.Array.indexOf(this.childNodes,a)},indexOfId:function(d){var c=this.childNodes,a=c.length,b=0;for(;b<a;++b){if(c[b].getId()===d){return b}}return -1},getPath:function(d,c){d=d||this.idProperty;c=c||"/";var b=[this.get(d)],a=this.parentNode;while(a){b.unshift(a.get(d));a=a.parentNode}return c+b.join(c)},getDepth:function(){return this.get("depth")},bubble:function(c,b,a){var d=this;while(d){if(c.apply(b||d,a||[d])===false){break}d=d.parentNode}},cascade:function(){if(Ext.isDefined(Ext.global.console)){Ext.global.console.warn("Ext.data.Node: cascade has been deprecated. Please use cascadeBy instead.")}return this.cascadeBy.apply(this,arguments)},cascadeBy:function(d,c,a){if(d.apply(c||this,a||[this])!==false){var f=this.childNodes,e=f.length,b;for(b=0;b<e;b++){f[b].cascadeBy(d,c,a)}}},eachChild:function(d,c,a){var f=this.childNodes,e=f.length,b;for(b=0;b<e;b++){if(d.apply(c||this,a||[f[b]])===false){break}}},findChild:function(b,c,a){return this.findChildBy(function(){return this.get(b)==c},null,a)},findChildBy:function(g,f,b){var e=this.childNodes,a=e.length,d=0,h,c;for(;d<a;d++){h=e[d];if(g.call(f||h,h)===true){return h}else{if(b){c=h.findChildBy(g,f,b);if(c!==null){return c}}}}return null},contains:function(a){return a.isAncestor(this)},isAncestor:function(a){var b=this.parentNode;while(b){if(b==a){return true}b=b.parentNode}return false},sort:function(f,b,a){var d=this.childNodes,e=d.length,c,g;if(e>0){Ext.Array.sort(d,f);for(c=0;c<e;c++){g=d[c];g.previousSibling=d[c-1];g.nextSibling=d[c+1];if(c===0){this.setFirstChild(g)}if(c==e-1){this.setLastChild(g)}g.updateInfo();if(b&&!g.isLeaf()){g.sort(f,true,true)}}if(a!==true){this.fireEvent("sort",this,d)}}},isExpanded:function(){return this.get("expanded")},isLoaded:function(){return this.get("loaded")},isLoading:function(){return this.get("loading")},isRoot:function(){return !this.parentNode},isVisible:function(){var a=this.parentNode;while(a){if(!a.isExpanded()){return false}a=a.parentNode}return true},expand:function(a,d,b){var c=this;if(!c.isLeaf()){if(c.isLoading()){c.on("expand",function(){c.expand(a,d,b)},c,{single:true})}else{if(!c.isExpanded()){c.fireEvent("beforeexpand",c,function(){c.set("expanded",true);if(c.hasListeners.expand){c.fireEvent("expand",c,c.childNodes,false)}if(a){c.expandChildren(true,d,b)}else{Ext.callback(d,b||c,[c.childNodes])}},c)}else{if(a){c.expandChildren(true,d,b)}else{Ext.callback(d,b||c,[c.childNodes])}}}}else{Ext.callback(d,b||c)}},expandChildren:function(d,h,j){var g=this,e=0,a=g.childNodes,f=a.length,c,b=0;for(;e<f;++e){c=a[e];if(!c.isLeaf()){b++;a[e].expand(d,function(){b--;if(h&&!b){Ext.callback(h,j||g,[g.childNodes])}})}}if(!b&&h){Ext.callback(h,j||g,[g.childNodes])}},collapse:function(a,d,b){var c=this;if(!c.isLeaf()){if(!c.collapsing&&c.isExpanded()){c.fireEvent("beforecollapse",c,function(){c.set("expanded",false);if(c.hasListeners.collapse){c.fireEvent("collapse",c,c.childNodes,false)}if(a){c.collapseChildren(true,d,b)}else{Ext.callback(d,b||c,[c.childNodes])}},c)}else{if(a){c.collapseChildren(true,d,b)}else{Ext.callback(d,b||c,[c.childNodes])}}}else{Ext.callback(d,b||c,[c.childNodes])}},collapseChildren:function(d,h,j){var g=this,e=0,b=g.childNodes,f=b.length,c,a=0;for(;e<f;++e){c=b[e];if(!c.isLeaf()){a++;b[e].collapse(d,function(){a--;if(h&&!a){Ext.callback(h,j||g,[g.childNodes])}})}}if(!a&&h){Ext.callback(h,j||g,[g.childNodes])}}}}}});