Ext.define("Ext.view.Table",{extend:"Ext.view.View",alias:"widget.tableview",requires:["Ext.view.TableLayout","Ext.view.NodeCache","Ext.util.DelayedTask","Ext.util.MixedCollection"],componentLayout:"tableview",baseCls:Ext.baseCSSPrefix+"grid-view",firstCls:Ext.baseCSSPrefix+"grid-cell-first",lastCls:Ext.baseCSSPrefix+"grid-cell-last",headerRowSelector:"tr."+Ext.baseCSSPrefix+"grid-header-row",selectedItemCls:Ext.baseCSSPrefix+"grid-row-selected",selectedCellCls:Ext.baseCSSPrefix+"grid-cell-selected",focusedItemCls:Ext.baseCSSPrefix+"grid-row-focused",overItemCls:Ext.baseCSSPrefix+"grid-row-over",altRowCls:Ext.baseCSSPrefix+"grid-row-alt",rowClsRe:new RegExp("(?:^|\\s*)"+Ext.baseCSSPrefix+"grid-row-(first|last|alt)(?:\\s+|$)","g"),cellRe:new RegExp(Ext.baseCSSPrefix+"grid-cell-([^\\s]+) ",""),positionBody:true,trackOver:true,getRowClass:null,stripeRows:true,markDirty:true,tpl:"{%values.view.tableTpl.applyOut(values, out)%}",tableTpl:['<table id="{view.id}-table" class="'+Ext.baseCSSPrefix+"{view.id}-table "+Ext.baseCSSPrefix+'grid-table" border="0" cellspacing="0" cellpadding="0" style="{tableStyle}">',"{[values.view.renderColumnSizer(out)]}","{[this.renderTHead(values, out)]}","{[this.renderTFoot(values, out)]}",'<tbody id="{view.id}-body">',"{%","values.view.renderRows(values.rows, values.viewStartIndex, out);","%}","</tbody>","</table>",{priority:0,renderTHead:Ext.emptyFn,renderTFoot:Ext.emptyFn}],rowTpl:["{%",'var dataRowCls = values.recordIndex === -1 ? "" : " '+Ext.baseCSSPrefix+'grid-data-row";',"%}",'<tr {[values.rowId ? ("id=\\"" + values.rowId + "\\"") : ""]} ','data-boundView="{view.id}" ','data-recordId="{record.internalId}" ','data-recordIndex="{recordIndex}" ','class="{[values.itemClasses.join(" ")]} {[values.rowClasses.join(" ")]}{[dataRowCls]}" ',"{rowAttr:attributes}>",'<tpl for="columns">{%',"parent.view.renderCell(values, parent.record, parent.recordIndex, xindex - 1, out, parent)","%}","</tpl>","</tr>",{priority:0}],cellTpl:['<td class="{tdCls}" {tdAttr}>','<div {unselectableAttr} class="'+Ext.baseCSSPrefix+'grid-cell-inner"','style="text-align:{align};<tpl if="style">{style}</tpl>">{value}</div>',"</td>",{priority:0}],refreshSelmodelOnRefresh:false,tableValues:{},rowValues:{itemClasses:[],rowClasses:[]},cellValues:{classes:[]},renderBuffer:document.createElement("div"),initComponent:function(){var b=this,a=b.scroll;this.addEvents("beforecellclick","cellclick","beforecelldblclick","celldblclick","beforecellcontextmenu","cellcontextmenu","beforecellmousedown","cellmousedown","beforecellmouseup","cellmouseup","beforecellkeydown","cellkeydown");b.body=new Ext.dom.Element.Fly();b.body.id=b.id+"gridBody";b.autoScroll=undefined;if(!b.trackOver){b.overItemCls=null}if(a===true||a==="both"){b.autoScroll=true}else{if(a==="horizontal"){b.overflowX="auto"}else{if(a==="vertical"){b.overflowY="auto"}}}b.selModel.view=b;b.headerCt.view=b;b.headerCt.markDirty=b.markDirty;b.grid.view=b;b.initFeatures(b.grid);delete b.grid;b.tpl=b.getTpl("tpl");b.itemSelector=b.getItemSelector();b.all=new Ext.view.NodeCache(b);b.callParent()},moveColumn:function(a,n,d){var m=this,k=(d>1)?document.createDocumentFragment():undefined,c=n,o=m.getGridColumns().length,g=o-1,b=(m.firstCls||m.lastCls)&&(n===0||n==o||a===0||a==g),f,e,r,h,l,q,p;if(m.rendered&&n!==a){r=m.el.query(m.getDataRowSelector());if(n>a&&k){c-=d}for(f=0,h=r.length;f<h;f++){l=r[f];q=l.childNodes;if(b){if(q.length===1){Ext.fly(q[0]).addCls(m.firstCls);Ext.fly(q[0]).addCls(m.lastCls);continue}if(a===0){Ext.fly(q[0]).removeCls(m.firstCls);Ext.fly(q[1]).addCls(m.firstCls)}else{if(a===g){Ext.fly(q[g]).removeCls(m.lastCls);Ext.fly(q[g-1]).addCls(m.lastCls)}}if(n===0){Ext.fly(q[0]).removeCls(m.firstCls);Ext.fly(q[a]).addCls(m.firstCls)}else{if(n===o){Ext.fly(q[g]).removeCls(m.lastCls);Ext.fly(q[a]).addCls(m.lastCls)}}}if(k){for(e=0;e<d;e++){k.appendChild(q[a])}l.insertBefore(k,q[c]||null)}else{l.insertBefore(q[a],q[c]||null)}}p=m.el.query(m.getBodySelector());for(f=0,h=p.length;f<h;f++){l=p[f];if(k){for(e=0;e<d;e++){k.appendChild(l.childNodes[a])}l.insertBefore(k,l.childNodes[c]||null)}else{l.insertBefore(l.childNodes[a],l.childNodes[c]||null)}}}},scrollToTop:Ext.emptyFn,addElListener:function(a,c,b){this.mon(this,a,c,b,{element:"el"})},getGridColumns:function(){return this.headerCt.getGridColumns()},getHeaderAtIndex:function(a){return this.headerCt.getHeaderAtIndex(a)},getCell:function(a,b){var c=this.getNode(a,true);return Ext.fly(c).down(b.getCellSelector())},getFeature:function(b){var a=this.featuresMC;if(a){return a.get(b)}},findFeature:function(a){if(this.features){return Ext.Array.findBy(this.features,function(b){if(b.ftype===a){return true}})}},initFeatures:function(d){var f=this,c,e,b,a;f.tableTpl=Ext.XTemplate.getTpl(this,"tableTpl");f.rowTpl=Ext.XTemplate.getTpl(this,"rowTpl");f.cellTpl=Ext.XTemplate.getTpl(this,"cellTpl");f.featuresMC=new Ext.util.MixedCollection();e=f.features=f.constructFeatures();a=e?e.length:0;for(c=0;c<a;c++){b=e[c];b.view=f;b.grid=d;f.featuresMC.add(b);b.init(d)}},addTableTpl:function(a){return this.addTpl("tableTpl",a)},addRowTpl:function(a){return this.addTpl("rowTpl",a)},addCellTpl:function(a){return this.addTpl("cellTpl",a)},addTpl:function(e,d){var c=this,a,b;d=Ext.Object.chain(d);if(!d.isTemplate){d.applyOut=c.tplApplyOut}for(a=c[e];d.priority<a.priority;a=a.nextTpl){b=a}if(b){b.nextTpl=d}else{c[e]=d}d.nextTpl=a;return d},tplApplyOut:function(a,b){if(this.before){if(this.before(a,b)===false){return}}this.nextTpl.applyOut(a,b);if(this.after){this.after(a,b)}},constructFeatures:function(){var f=this,e=f.features,d,b,c=0,a;if(e){b=[];a=e.length;for(;c<a;c++){d=e[c];if(!d.isFeature){d=Ext.create("feature."+d.ftype,d)}b[c]=d}}return b},beforeRender:function(){var a=this;a.callParent();if(!a.enableTextSelection){a.protoEl.unselectable()}},onViewScroll:function(b,a){this.callParent(arguments);this.fireEvent("bodyscroll",b,a)},createRowElement:function(a,b){var c=this,d=c.renderBuffer;c.tpl.overwrite(d,c.collectData([a],b));return Ext.fly(d).down(c.getNodeContainerSelector(),true).firstChild},bufferRender:function(a,b){var c=this,d=c.renderBuffer;c.tpl.overwrite(d,c.collectData(a,b));return Ext.Array.toArray(Ext.fly(d).down(c.getNodeContainerSelector(),true).childNodes)},collectData:function(a,b){this.rowValues.view=this;return{view:this,rows:a,viewStartIndex:b,tableStyle:this.bufferedRenderer?("position:absolute;top:"+this.bufferedRenderer.bodyTop):""}},collectNodes:function(a){this.all.fill(this.getNodeContainer().childNodes,this.all.startIndex)},refreshSize:function(){var c=this,b,a=c.getBodySelector();if(a){c.body.attach(c.el.child(a,true))}if(!c.hasLoadingHeight){b=c.up("tablepanel");Ext.suspendLayouts();c.callParent();if(b&&(Ext.getScrollbarSize().width&&c.scrollFlags.y)||(b.lockable&&b.syncRowHeight)){b.updateLayout()}Ext.resumeLayouts(true)}},statics:{getBoundView:function(a){return Ext.getCmp(a.getAttribute("data-boundView"))}},getRecord:function(b){b=this.getNode(b);if(b){var a=b.getAttribute("data-recordIndex");if(a){a=parseInt(a,10);if(a>-1){return this.store.data.getAt(a)}}return this.dataSource.data.get(b.getAttribute("data-recordId"))}},indexOf:function(a){a=this.getNode(a,false);if(!a&&a!==0){return -1}return this.all.indexOf(a)},indexInStore:function(b){b=this.getNode(b,true);if(!b&&b!==0){return -1}var a=b.getAttribute("data-recordIndex");if(a){return parseInt(a,10)}return this.dataSource.indexOf(this.getRecord(b))},renderRows:function(e,d,b){var f=this.rowValues,a=e.length,g=this.getHeaderCt(),c;f.view=this;f.columns=g.getGridColumns(true);f.visibleColumns=g.getVisibleGridColumns();for(c=0;c<a;c++,d++){f.itemClasses.length=f.rowClasses.length=0;this.renderRow(e[c],d,b)}f.view=f.columns=f.visibleColumns=f.record=null},renderColumnSizer:function(b){var d=this.getGridColumns(),a=d.length,c,f,e;for(c=0;c<a;c++){f=d[c];e=f.hidden?0:(f.lastBox?f.lastBox.width:Ext.grid.header.Container.prototype.defaultWidth);b.push('<colgroup><col class="',Ext.baseCSSPrefix,"grid-cell-",d[c].getItemId(),'" style="width:'+e+'px"></colgroup>')}},renderRow:function(f,a,e){var h=this,d=a===-1,g=h.selModel,k=h.rowValues,c=k.itemClasses,b=k.rowClasses,j,i=h.rowTpl;k.record=f;k.recordId=f.internalId;k.recordIndex=a;k.rowId=h.getRowId(f);k.itemCls=k.rowCls="";if(!k.columns){k.columns=h.headerCt.getGridColumns(true)}c.length=b.length=0;if(!d){c[0]=Ext.baseCSSPrefix+"grid-row";if(g&&g.isRowSelected&&g.isRowSelected(f,a)){c.push(h.selectedItemCls)}if(h.stripeRows&&a%2!==0){b.push(h.altRowCls)}if(h.getRowClass){j=h.getRowClass(f,a,null,h.dataSource);if(j){b.push(j)}}}if(e){i.applyOut(k,e)}else{return i.apply(k)}},renderCell:function(c,f,e,h,d){var j=this,g=j.selModel,i=j.cellValues,b=i.classes,a=f.data[c.dataIndex],k=j.cellTpl,l;i.record=f;i.column=c;i.recordIndex=e;i.columnIndex=h;i.align=c.align;i.tdCls=i.style=i.tdAttr="";i.unselectableAttr=j.enableTextSelection?"":'unselectable="on"';if(c.renderer.call){l=c.renderer.call(c.scope||j.ownerCt,a,i,f,e,h,j.dataSource,j);if(i.css){f.cssWarning=true;i.tdCls+=" "+i.css;delete i.css}}else{l=a}if(l===undefined||l===null||l===""){l="&#160;"}i.value=l;b.length=0;b.push((c.tdCls||""),Ext.baseCSSPrefix+"grid-cell "+Ext.baseCSSPrefix+"grid-cell-"+c.getItemId());if(f.isModified(c.dataIndex)){b.push(this.headerCt.dirtyCls)}if(c.isFirstVisible){b.push(j.firstCls)}if(c.isLastVisible){b.push(j.lastCls)}if(!this.enableTextSelection){b.push(Ext.baseCSSPrefix+"unselectable")}b.push(i.tdCls);if(g&&g.isCellSelected&&g.isCellSelected(e,h)){b.push(j.selectedCellCls)}i.tdCls=b.join(" ");k.applyOut(i,d);i.column=null},getNode:function(c,b){var d,a=this.callParent(arguments);if(a&&a.tagName){if(b){if(!(d=Ext.fly(a)).is(this.dataRowSelector)){return d.down(this.dataRowSelector,true)}}else{if(b===false){if(!(d=Ext.fly(a)).is(this.itemSelector)){return d.up(this.itemSelector,null,true)}}}}return a},getRowId:function(a){return this.id+"-record-"+a.internalId},getNodeByRecord:function(b,d){var a=this.el.getById(this.getRowId(b),true),c=this.itemSelector,e;if(d===false){if(!(e=Ext.fly(a)).is(c)){return e.up(c,null,true)}}return a},updateIndexes:Ext.emptyFn,bodySelector:"table",nodeContainerSelector:"tbody",itemSelector:"tr."+Ext.baseCSSPrefix+"grid-row",dataRowSelector:"tr."+Ext.baseCSSPrefix+"grid-data-row",cellSelector:"td."+Ext.baseCSSPrefix+"grid-cell",sizerSelector:"col."+Ext.baseCSSPrefix+"grid-cell",innerSelector:"div."+Ext.baseCSSPrefix+"grid-cell-inner",getNodeContainer:function(){return this.el.down(this.nodeContainerSelector,true)},getBodySelector:function(){return this.bodySelector+"."+Ext.baseCSSPrefix+this.id+"-table"},getNodeContainerSelector:function(){return this.nodeContainerSelector},getColumnSizerSelector:function(a){return this.sizerSelector+"-"+a.getItemId()},getItemSelector:function(){return this.itemSelector},getDataRowSelector:function(){return this.dataRowSelector},getCellSelector:function(b){var a=this.cellSelector;if(b){a+="-"+b.getItemId()}return a},getCellInnerSelector:function(a){return this.getCellSelector(a)+" "+this.innerSelector},addRowCls:function(b,a){var c=this.getNode(b,false);if(c){Ext.fly(c).addCls(a)}},removeRowCls:function(b,a){var c=this.getNode(b,false);if(c){Ext.fly(c).removeCls(a)}},onRowSelect:function(a){this.addRowCls(a,this.selectedItemCls)},onRowDeselect:function(b){var a=this;a.removeRowCls(b,a.selectedItemCls);a.removeRowCls(b,a.focusedItemCls)},onCellSelect:function(b){var a=this.getCellByPosition(b,true);if(a){Ext.fly(a).addCls(this.selectedCellCls)}},onCellDeselect:function(b){var a=this.getCellByPosition(b,true);if(a){Ext.fly(a).removeCls(this.selectedCellCls)}},onCellFocus:function(a){this.focusCell(a)},getCellByPosition:function(a,b){if(a){var c=this.getNode(a.row,true),d=this.headerCt.getHeaderAtIndex(a.column);if(d&&c){return Ext.fly(c).down(this.getCellSelector(d),b)}}return false},onRowFocus:function(d,b,a){var c=this;if(b){c.addRowCls(d,c.focusedItemCls);if(!a){c.focusRow(d)}}else{c.removeRowCls(d,c.focusedItemCls)}},focusRow:function(b){var f=this,j=f.getNode(b,true),c=f.el,h=0,a=f.ownerCt,i,g,e,d;if(j&&c){g=c.getY();e=g+c.dom.clientHeight;i=Ext.fly(j).getRegion();if(i.top<g){h=i.top-g}else{if(i.bottom>e){h=i.bottom-e}}d=f.getRecord(j);b=f.dataSource.indexOf(d);if(h){a.scrollByDeltaY(h)}c.focus();f.fireEvent("rowfocus",d,j,b)}},focusCell:function(g){var i=this,j=i.getCellByPosition(g),f=i.getRecord(g.row),b=i.el,d=0,e=0,c=b.getRegion(),a=i.ownerCt,h;c.bottom=c.top+b.dom.clientHeight;c.right=c.left+b.dom.clientWidth;if(j){h=j.getRegion();if(h.top<c.top){d=h.top-c.top}else{if(h.bottom>c.bottom){d=h.bottom-c.bottom}}if(h.left<c.left){e=h.left-c.left}else{if(h.right>c.right){e=h.right-c.right}}if(d){a.scrollByDeltaY(d)}if(e){a.scrollByDeltaX(e)}b.focus();i.fireEvent("cellfocus",f,j,g)}},scrollByDelta:function(c,b){b=b||"scrollTop";var a=this.el.dom;a[b]=(a[b]+=c)},isDataRow:function(a){return Ext.fly(a).hasCls(Ext.baseCSSPrefix+"grid-data-row")},syncRowHeights:function(f,a){f=Ext.get(f);a=Ext.get(a);f.dom.style.height=a.dom.style.height="";var d=this,e=d.rowTpl,b=f.dom.offsetHeight,c=a.dom.offsetHeight;if(b!==c){while(e){if(e.syncRowHeights){if(e.syncRowHeights(f,a)===false){break}}e=e.nextTpl}b=f.dom.offsetHeight;c=a.dom.offsetHeight;if(b!==c){f=f.down("[data-recordId]")||f;a=a.down("[data-recordId]")||a;if(f&&a){f.dom.style.height=a.dom.style.height="";b=f.dom.offsetHeight;c=a.dom.offsetHeight;if(b>c){a.setHeight(b)}else{if(c>b){f.setHeight(c)}}}}}},onUpdate:function(p,f,e,n){var m=this,q=m.rowTpl,h,j,l,o,b,a,g,c,i,d,k;if(m.viewReady){l=m.getNodeByRecord(f,false);if(l){i=m.overItemCls;h=m.indexInStore(f);o=m.createRowElement(f,h);j=Ext.fly(l,"_internal");k=j.hasCls(i);d=m.headerCt.getGridColumns();if(l.mergeAttributes){l.mergeAttributes(o,true)}else{b=o.attributes;a=b.length;for(c=0;c<a;c++){g=b[c].name;if(g!=="id"){l.setAttribute(g,b[c].value)}}}if(k){j.addCls(i)}if(d.length){m.updateColumns(m.getNode(l,true),m.getNode(o,true),d,n)}while(q){if(q.syncContent){if(q.syncContent(l,o)===false){break}}q=q.nextTpl}m.fireEvent("itemupdate",f,h,l);m.refreshSize()}}},updateColumns:function(l,m,e,k){var j=this,b,a,i,c,o=e.length,n,d,p,g,q,h=j.editingPlugin&&j.editingPlugin.editing,f=j.getCellSelector();if(l.mergeAttributes){l.mergeAttributes(m,true)}else{b=m.attributes;a=b.length;for(c=0;c<a;c++){i=b[c].name;if(i!=="id"){l.setAttribute(i,b[c].value)}}}for(n=0;n<o;n++){d=e[n];if(j.shouldUpdateCell(d,k)){f=j.getCellSelector(d);p=Ext.DomQuery.selectNode(f,l);g=Ext.DomQuery.selectNode(f,m);if(h){Ext.fly(p).syncContent(g)}else{q=p.parentNode;q.insertBefore(g,p);q.removeChild(p)}}}},shouldUpdateCell:function(b,a){if(b.hasCustomRenderer){return true}return !a||Ext.Array.contains(a,b.dataIndex)},refresh:function(){var a=this;a.callParent(arguments);a.headerCt.setSortState();a.selModel.onLastFocusChanged(null,a.selModel.lastFocused)},processItemEvent:function(d,q,m,h){if(this.indexInStore(q)!==-1){var k=this,n=h.getTarget(k.getCellSelector(),q),l,a=k.statics().EventMap,f=k.getSelectionModel(),j=h.type,b=k.features,g=b.length,c,p,o;if(j=="keydown"&&!n&&f.getCurrentPosition){n=k.getCellByPosition(f.getCurrentPosition(),true)}l=n?(n.cellIndex||Number(n.getAttribute("data-cellIndex"))):-1;p=k.fireEvent("uievent",j,k,n,m,l,h,d,q);if(p===false||k.callParent(arguments)===false){return false}for(c=0;c<g;++c){o=b[c];if(o.wrapsItem){if(o.vetoEvent(d,q,m,h)===false){k.processSpecialEvent(h);return false}}}if(j=="mouseover"||j=="mouseout"){return true}if(!n){return true}return !((k["onBeforeCell"+a[j]](n,l,d,q,m,h)===false)||(k.fireEvent("beforecell"+j,k,n,l,d,q,m,h)===false)||(k["onCell"+a[j]](n,l,d,q,m,h)===false)||(k.fireEvent("cell"+j,k,n,l,d,q,m,h)===false))}},processSpecialEvent:function(h){var l=this,c=l.features,k=c.length,m=h.type,d,n,f,g,b,j,a=l.ownerCt;l.callParent(arguments);if(m=="mouseover"||m=="mouseout"){return}for(d=0;d<k;d++){n=c[d];if(n.hasFeatureEvent){g=h.getTarget(n.eventSelector,l.getTargetEl());if(g){f=n.eventPrefix;b=n.getFireEventArgs("before"+f+m,l,g,h);j=n.getFireEventArgs(f+m,l,g,h);if((l.fireEvent.apply(l,b)===false)||(a.fireEvent.apply(a,b)===false)||(l.fireEvent.apply(l,j)===false)||(a.fireEvent.apply(a,j)===false)){return false}}}}return true},onCellMouseDown:Ext.emptyFn,onCellMouseUp:Ext.emptyFn,onCellClick:Ext.emptyFn,onCellDblClick:Ext.emptyFn,onCellContextMenu:Ext.emptyFn,onCellKeyDown:Ext.emptyFn,onBeforeCellMouseDown:Ext.emptyFn,onBeforeCellMouseUp:Ext.emptyFn,onBeforeCellClick:Ext.emptyFn,onBeforeCellDblClick:Ext.emptyFn,onBeforeCellContextMenu:Ext.emptyFn,onBeforeCellKeyDown:Ext.emptyFn,expandToFit:function(a){this.autoSizeColumn(a)},autoSizeColumn:function(a){if(Ext.isNumber(a)){a=this.getGridColumns[a]}if(a){if(a.isGroupHeader){a.autoSize();return}delete a.flex;a.setWidth(this.getMaxContentWidth(a))}},getMaxContentWidth:function(g){var e=this,a=e.el.query(g.getCellInnerSelector()),f=g.getWidth(),b=0,d=a.length,c;e.body.select(e.getColumnSizerSelector(g)).setWidth(40);c=g.textEl.dom.offsetWidth+g.titleEl.getPadding("lr");for(;b<d;b++){c=Math.max(c,a[b].scrollWidth+2)}e.body.select(e.getColumnSizerSelector(g)).setWidth(f);return c},getPositionByEvent:function(f){var d=this,b=f.getTarget(d.cellSelector),c=f.getTarget(d.itemSelector),a=d.getRecord(c),g=d.getHeaderByCell(b);return d.getPosition(a,g)},getHeaderByCell:function(b){if(b){var a=b.className.match(this.cellRe);if(a&&a[1]){return Ext.getCmp(a[1])}}return false},walkCells:function(k,l,g,m,a,n){if(!k){return false}var i=this,o=k.row,d=k.column,j=i.dataSource.getCount(),f=i.getFirstVisibleColumnIndex(),b=i.getLastVisibleColumnIndex(),h={row:o,column:d},c=i.headerCt.getHeaderAtIndex(d);if(!c||c.hidden||!j){return false}g=g||{};l=l.toLowerCase();switch(l){case"right":if(d===b){if(m||o===j-1){return false}if(!g.ctrlKey){h.row=i.walkRows(o,1);if(h.row!==o){h.column=f}}}else{if(!g.ctrlKey){h.column=d+i.getRightGap(c)}else{h.column=b}}break;case"left":if(d===f){if(m||o===0){return false}if(!g.ctrlKey){h.row=i.walkRows(o,-1);if(h.row!==o){h.column=b}}}else{if(!g.ctrlKey){h.column=d+i.getLeftGap(c)}else{h.column=f}}break;case"up":if(o===0){return false}else{if(!g.ctrlKey){h.row=i.walkRows(o,-1)}else{h.row=i.walkRows(-1,1)}}break;case"down":if(o===j-1){return false}else{if(!g.ctrlKey){h.row=i.walkRows(o,1)}else{h.row=i.walkRows(j,-1)}}break}if(a&&a.call(n||window,h)!==true){return false}else{return h}},walkRows:function(d,b){var g=this,f,e=g.dataSource.getCount(),c=b===-1?0:e-1,a=d;do{if(a===c){return d}a+=b}while(!(f=Ext.fly(g.getNode(a,true)))||!f.isVisible(true));return a},getFirstVisibleRowIndex:function(){var c=this,b=c.dataSource.getCount(),a=0;do{a+=1;if(a===b){return}}while(!Ext.fly(c.getNode(a,true)).isVisible(true));return a},getLastVisibleRowIndex:function(){var c=this,b=c.dataSource.getCount(),a=b;do{a-=1;if(a===-1){return}}while(!Ext.fly(c.getNode(a,true)).isVisible(true));return a},getFirstVisibleColumnIndex:function(){var a=this.getHeaderCt().getVisibleGridColumns()[0];return a?a.getIndex():-1},getLastVisibleColumnIndex:function(){var b=this.getHeaderCt().getVisibleGridColumns(),a=b[b.length-1];return a.getIndex()},getHeaderCt:function(){return this.headerCt},getPosition:function(a,b){return{row:this.dataSource.indexOf(a,true),column:Ext.Array.indexOf(this.headerCt.getGridColumns(),b)}},getRightGap:function(a){var f=this.getHeaderCt(),e=f.getGridColumns(),b=Ext.Array.indexOf(e,a),c=b+1,d;for(;c<=e.length;c++){if(!e[c].hidden){d=c;break}}return d-b},beforeDestroy:function(){var a=this;if(a.rendered){a.el.removeAllListeners()}a.callParent(arguments)},getLeftGap:function(a){var f=this.getHeaderCt(),e=f.getGridColumns(),c=Ext.Array.indexOf(e,a),d=c-1,b;for(;d>=0;d--){if(!e[d].hidden){b=d;break}}return b-c},onAdd:function(c,a,b){this.callParent(arguments);this.doStripeRows(b)},onRemove:function(c,a,b){this.callParent(arguments);this.doStripeRows(b[0])},doStripeRows:function(b,a){var d=this,e,g,c,f;if(d.rendered&&d.stripeRows){e=d.getNodes(b,a);for(c=0,g=e.length;c<g;c++){f=e[c];f.className=f.className.replace(d.rowClsRe," ");b++;if(b%2===0){f.className+=(" "+d.altRowCls)}}}}});