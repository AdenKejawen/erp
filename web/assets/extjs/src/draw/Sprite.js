Ext.define("Ext.draw.Sprite",{mixins:{observable:"Ext.util.Observable",animate:"Ext.util.Animate"},requires:["Ext.draw.SpriteDD"],dirty:false,dirtyHidden:false,dirtyTransform:false,dirtyPath:true,dirtyFont:true,zIndexDirty:true,isSprite:true,zIndex:0,fontProperties:["font","font-size","font-weight","font-style","font-family","text-anchor","text"],pathProperties:["x","y","d","path","height","width","radius","r","rx","ry","cx","cy"],constructor:function(a){var b=this;a=Ext.merge({},a||{});b.id=Ext.id(null,"ext-sprite-");b.transformations=[];Ext.copyTo(this,a,"surface,group,type,draggable");b.bbox={};b.attr={zIndex:0,translation:{x:null,y:null},rotation:{degrees:null,x:null,y:null},scaling:{x:null,y:null,cx:null,cy:null}};delete a.surface;delete a.group;delete a.type;delete a.draggable;b.setAttributes(a);b.addEvents("beforedestroy","destroy","render","mousedown","mouseup","mouseover","mouseout","mousemove","click");b.mixins.observable.constructor.apply(this,arguments)},initDraggable:function(){var a=this;if(!a.el){a.surface.createSpriteElement(a)}a.dd=new Ext.draw.SpriteDD(a,Ext.isBoolean(a.draggable)?null:a.draggable);a.on("beforedestroy",a.dd.destroy,a.dd)},setAttributes:function(k,n){var s=this,h=s.fontProperties,p=h.length,g=s.pathProperties,f=g.length,q=!!s.surface,a=q&&s.surface.customAttributes||{},c=s.attr,b=false,l,o,j,d,r,m,t,e;k=Ext.apply({},k);for(l in a){if(k.hasOwnProperty(l)&&typeof a[l]=="function"){Ext.apply(k,a[l].apply(s,[].concat(k[l])))}}if(!!k.hidden!==!!c.hidden){s.dirtyHidden=true}for(o=0;o<f;o++){l=g[o];if(l in k&&k[l]!==c[l]){s.dirtyPath=true;b=true;break}}if("zIndex" in k){s.zIndexDirty=true}if("text" in k){s.dirtyFont=true;b=true}for(o=0;o<p;o++){l=h[o];if(l in k&&k[l]!==c[l]){s.dirtyFont=true;b=true;break}}j=k.translation||k.translate;delete k.translate;delete k.translation;d=c.translation;if(j){if(("x" in j&&j.x!==d.x)||("y" in j&&j.y!==d.y)){s.dirtyTransform=true;d.x=j.x;d.y=j.y}}r=k.rotation||k.rotate;m=c.rotation;delete k.rotate;delete k.rotation;if(r){if(("x" in r&&r.x!==m.x)||("y" in r&&r.y!==m.y)||("degrees" in r&&r.degrees!==m.degrees)){s.dirtyTransform=true;m.x=r.x;m.y=r.y;m.degrees=r.degrees}}t=k.scaling||k.scale;e=c.scaling;delete k.scale;delete k.scaling;if(t){if(("x" in t&&t.x!==e.x)||("y" in t&&t.y!==e.y)||("cx" in t&&t.cx!==e.cx)||("cy" in t&&t.cy!==e.cy)){s.dirtyTransform=true;e.x=t.x;e.y=t.y;e.cx=t.cx;e.cy=t.cy}}if(!s.dirtyTransform&&b){if(c.scaling.x===null||c.scaling.y===null||c.rotation.y===null||c.rotation.y===null){s.dirtyTransform=true}}Ext.apply(c,k);s.dirty=true;if(n===true&&q){s.redraw()}return this},getBBox:function(){return this.surface.getBBox(this)},setText:function(a){return this.surface.setText(this,a)},hide:function(a){this.setAttributes({hidden:true},a);return this},show:function(a){this.setAttributes({hidden:false},a);return this},remove:function(){if(this.surface){this.surface.remove(this);return true}return false},onRemove:function(){this.surface.onRemove(this)},destroy:function(){var a=this;if(a.fireEvent("beforedestroy",a)!==false){a.remove();a.surface.onDestroy(a);a.clearListeners();a.fireEvent("destroy")}},redraw:function(){this.surface.renderItem(this);return this},setStyle:function(){this.el.setStyle.apply(this.el,arguments);return this},addCls:function(a){this.surface.addCls(this,a);return this},removeCls:function(a){this.surface.removeCls(this,a);return this}});