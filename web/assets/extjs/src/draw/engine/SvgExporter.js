Ext.define("Ext.draw.engine.SvgExporter",function(){var b=/,/g,c=/(-?\d*\.?\d*){1}(em|ex|px|in|cm|mm|pt|pc|%)\s('*.*'*)/,i=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,g=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,([\d\.]+)\)/g,f,h,e,l,m=function(n){f=n;h=f.length;e=f.width;l=f.height},j={path:function(r){var n=r.attr,u=n.path,q="",s,t,o;if(Ext.isArray(u[0])){o=u.length;for(t=0;t<o;t++){q+=u[t].join(" ")}}else{if(Ext.isArray(u)){q=u.join(" ")}else{q=u.replace(b," ")}}s=d({d:q,fill:n.fill||"none",stroke:n.stroke,"fill-opacity":n.opacity,"stroke-width":n["stroke-width"],"stroke-opacity":n["stroke-opacity"],"z-index":n.zIndex,transform:r.matrix.toSvg()});return"<path "+s+"/>"},text:function(t){var q=t.attr,p=c.exec(q.font),v=(p&&p[1])||"12",o=(p&&p[3])||"Arial",u=q.text,s=(Ext.isFF3_0||Ext.isFF3_5)?2:4,n="",r;t.getBBox();n+='<tspan x="'+(q.x||"")+'" dy="';n+=(v/s)+'">';n+=Ext.htmlEncode(u)+"</tspan>";r=d({x:q.x,y:q.y,"font-size":v,"font-family":o,"font-weight":q["font-weight"],"text-anchor":q["text-anchor"],fill:q.fill||"#000","fill-opacity":q.opacity,transform:t.matrix.toSvg()});return"<text "+r+">"+n+"</text>"},rect:function(o){var n=o.attr,p=d({x:n.x,y:n.y,rx:n.rx,ry:n.ry,width:n.width,height:n.height,fill:n.fill||"none","fill-opacity":n.opacity,stroke:n.stroke,"stroke-opacity":n["stroke-opacity"],"stroke-width":n["stroke-width"],transform:o.matrix&&o.matrix.toSvg()});return"<rect "+p+"/>"},circle:function(o){var n=o.attr,p=d({cx:n.x,cy:n.y,r:n.radius,fill:n.translation.fill||n.fill||"none","fill-opacity":n.opacity,stroke:n.stroke,"stroke-opacity":n["stroke-opacity"],"stroke-width":n["stroke-width"],transform:o.matrix.toSvg()});return"<circle "+p+" />"},image:function(o){var n=o.attr,p=d({x:n.x-(n.width/2>>0),y:n.y-(n.height/2>>0),width:n.width,height:n.height,"xlink:href":n.src,transform:o.matrix.toSvg()});return"<image "+p+" />"}},a=function(){var n='<?xml version="1.0" standalone="yes"?>';n+='<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">';return n},k=function(){var v='<svg width="'+e+'px" height="'+l+'px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">',o="",G,E,u,p,F,I,y,w,s,x,A,n,J,t,D,B,H,C,r,q;u=f.items.items;E=u.length;F=function(N){var U=N.childNodes,R=U.length,Q=0,O,P,K="",L,T,M,S;for(;Q<R;Q++){L=U[Q];T=L.attributes;M=L.tagName;K+="<"+M;for(P=0,O=T.length;P<O;P++){S=T.item(P);K+=" "+S.name+'="'+S.value+'"'}K+=">";if(L.childNodes.length>0){K+=F(L)}K+="</"+M+">"}return K};if(f.getDefs){o=F(f.getDefs())}else{w=f.gradientsColl;if(w){s=w.keys;x=w.items;A=0;n=s.length}for(;A<n;A++){J=s[A];t=x[A];p=f.gradientsColl.getByKey(J);o+='<linearGradient id="'+J+'" x1="0" y1="0" x2="1" y2="1">';var z=p.colors.replace(i,"rgb($1|$2|$3)");z=z.replace(g,"rgba($1|$2|$3|$4)");I=z.split(",");for(D=0,H=I.length;D<H;D++){y=I[D].split(" ");z=Ext.draw.Color.fromString(y[1].replace(/\|/g,","));o+='<stop offset="'+y[0]+'" stop-color="'+z.toString()+'" stop-opacity="1"></stop>'}o+="</linearGradient>"}}v+="<defs>"+o+"</defs>";v+=j.rect({attr:{width:"100%",height:"100%",fill:"#fff",stroke:"none",opacity:"0"}});C=new Array(E);for(D=0;D<E;D++){C[D]=D}C.sort(function(L,K){r=u[L].attr.zIndex||0;q=u[K].attr.zIndex||0;if(r==q){return L-K}return r-q});for(D=0;D<E;D++){G=u[C[D]];if(!G.attr.hidden){v+=j[G.type](G)}}v+="</svg>";return v},d=function(p){var o="",n;for(n in p){if(p.hasOwnProperty(n)&&p[n]!=null){o+=n+'="'+p[n]+'" '}}return o};return{singleton:true,generate:function(n,o){o=o||{};m(n);return a()+k()}}});