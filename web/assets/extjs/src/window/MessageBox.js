Ext.define("Ext.window.MessageBox",{extend:"Ext.window.Window",requires:["Ext.toolbar.Toolbar","Ext.form.field.Text","Ext.form.field.TextArea","Ext.form.field.Display","Ext.button.Button","Ext.layout.container.Anchor","Ext.layout.container.HBox","Ext.ProgressBar"],alias:"widget.messagebox",OK:1,YES:2,NO:4,CANCEL:8,OKCANCEL:9,YESNO:6,YESNOCANCEL:14,INFO:Ext.baseCSSPrefix+"message-box-info",WARNING:Ext.baseCSSPrefix+"message-box-warning",QUESTION:Ext.baseCSSPrefix+"message-box-question",ERROR:Ext.baseCSSPrefix+"message-box-error",hideMode:"offsets",closeAction:"hide",resizable:false,title:"&#160;",defaultMinWidth:250,defaultMaxWidth:600,defaultMinHeight:110,defaultMaxHeight:500,minWidth:null,maxWidth:null,minHeight:null,maxHeight:null,constrain:true,cls:[Ext.baseCSSPrefix+"message-box",Ext.baseCSSPrefix+"hide-offsets"],layout:{type:"vbox",align:"stretch"},shrinkWrapDock:true,defaultTextHeight:75,minProgressWidth:250,minPromptWidth:250,buttonText:{ok:"OK",yes:"Yes",no:"No",cancel:"Cancel"},buttonIds:["ok","yes","no","cancel"],titleText:{confirm:"Confirm",prompt:"Prompt",wait:"Loading...",alert:"Attention"},iconHeight:35,iconWidth:50,makeButton:function(a){var b=this.buttonIds[a];return new Ext.button.Button({handler:this.btnCallback,itemId:b,scope:this,text:this.buttonText[b],minWidth:75})},btnCallback:function(a){var b=this,c,d;if(b.cfg.prompt||b.cfg.multiline){if(b.cfg.multiline){d=b.textArea}else{d=b.textField}c=d.getValue();d.reset()}b.hide();b.userCallback(a.itemId,c,b.cfg)},hide:function(){var b=this,a=b.cfg.cls;b.dd.endDrag();b.progressBar.reset();if(a){b.removeCls(a)}b.callParent(arguments)},constructor:function(a){var b=this;b.callParent(arguments);b.minWidth=b.defaultMinWidth=(b.minWidth||b.defaultMinWidth);b.maxWidth=b.defaultMaxWidth=(b.maxWidth||b.defaultMaxWidth);b.minHeight=b.defaultMinHeight=(b.minHeight||b.defaultMinHeight);b.maxHeight=b.defaultMaxHeight=(b.maxHeight||b.defaultMaxHeight)},initComponent:function(a){var e=this,b=e.id,d,c;e.title="&#160;";e.topContainer=new Ext.container.Container({layout:"hbox",padding:10,style:{overflow:"hidden"},items:[e.iconComponent=new Ext.Component({width:e.iconWidth,height:e.iconHeight}),e.promptContainer=new Ext.container.Container({flex:1,layout:"anchor",items:[e.msg=new Ext.form.field.Display({id:b+"-displayfield",cls:e.baseCls+"-text"}),e.textField=new Ext.form.field.Text({id:b+"-textfield",anchor:"100%",enableKeyEvents:true,listeners:{keydown:e.onPromptKey,scope:e}}),e.textArea=new Ext.form.field.TextArea({id:b+"-textarea",anchor:"100%",height:75})]})]});e.progressBar=new Ext.ProgressBar({id:b+"-progressbar",margins:"0 10 10 10"});e.items=[e.topContainer,e.progressBar];e.msgButtons=[];for(d=0;d<4;d++){c=e.makeButton(d);e.msgButtons[c.itemId]=c;e.msgButtons.push(c)}e.bottomTb=new Ext.toolbar.Toolbar({id:b+"-toolbar",ui:"footer",dock:"bottom",layout:{pack:"center"},items:[e.msgButtons[0],e.msgButtons[1],e.msgButtons[2],e.msgButtons[3]]});e.dockedItems=[e.bottomTb];e.on("close",e.onClose,e);e.callParent()},onClose:function(){var a=this.header.child("[type=close]");a.itemId="cancel";this.btnCallback(a);delete a.itemId},onPromptKey:function(a,c){var b=this;if(c.keyCode===c.RETURN||c.keyCode===10){if(b.msgButtons.ok.isVisible()){b.msgButtons.ok.handler.call(b,b.msgButtons.ok)}else{if(b.msgButtons.yes.isVisible()){b.msgButtons.yes.handler.call(b,b.msgButtons.yes)}}}},reconfigure:function(l){var m=this,n=0,j=true,a=m.buttonText,o=m.resizer,b,c,p,h,d,g,f,k,e;m.updateButtonText();l=l||{};m.cfg=l;if(l.width){c=l.width}if(l.height){p=l.height}m.minWidth=l.minWidth||m.defaultMinWidth;m.maxWidth=l.maxWidth||m.defaultMaxWidth;m.minHeight=l.minHeight||m.defaultMinHeight;m.maxHeight=l.maxHeight||m.defaultMaxHeight;if(o){b=o.resizeTracker;o.minWidth=b.minWidth=m.minWidth;o.maxWidth=b.maxWidth=m.maxWidth;o.minHeight=b.minHeight=m.minHeight;o.maxHeight=b.maxHeight=m.maxHeight}delete m.defaultFocus;if(l.defaultFocus){m.defaultFocus=l.defaultFocus}m.animateTarget=l.animateTarget||undefined;m.modal=l.modal!==false;m.setTitle(l.title||"");m.setIconCls(l.iconCls||"");if(Ext.isObject(l.buttons)){m.buttonText=l.buttons;n=0}else{m.buttonText=l.buttonText||m.buttonText;n=Ext.isNumber(l.buttons)?l.buttons:0}n=n|m.updateButtonText();m.buttonText=a;Ext.suspendLayouts();delete m.width;delete m.height;if(c||p){if(c){m.setWidth(c)}if(p){m.setHeight(p)}}m.hidden=false;if(!m.rendered){m.render(Ext.getBody())}m.closable=l.closable!==false&&!l.wait;m.header.child("[type=close]").setVisible(m.closable);if(!l.title&&!m.closable&&!l.iconCls){m.header.hide()}else{m.header.show()}m.liveDrag=!l.proxyDrag;m.userCallback=Ext.Function.bind(l.callback||l.fn||Ext.emptyFn,l.scope||Ext.global);m.setIcon(l.icon,l.iconWidth,l.iconHeight);f=m.msg;if(l.msg){f.setValue(l.msg);f.show()}else{f.hide()}d=m.textArea;g=m.textField;if(l.prompt||l.multiline){m.multiline=l.multiline;if(l.multiline){d.setValue(l.value);d.setHeight(l.defaultTextHeight||m.defaultTextHeight);d.show();g.hide();m.defaultFocus=d}else{g.setValue(l.value);d.hide();g.show();m.defaultFocus=g}}else{d.hide();g.hide()}k=m.progressBar;if(l.progress||l.wait){k.show();m.updateProgress(0,l.progressText);if(l.wait===true){k.wait(l.waitConfig)}}else{k.hide()}e=m.msgButtons;for(h=0;h<4;h++){if(n&Math.pow(2,h)){if(!m.defaultFocus){m.defaultFocus=e[h]}e[h].show();j=false}else{e[h].hide()}}if(j){m.bottomTb.hide()}else{m.bottomTb.show()}Ext.resumeLayouts(true)},updateButtonText:function(){var d=this,c=d.buttonText,b=0,e,a;for(e in c){if(c.hasOwnProperty(e)){a=d.msgButtons[e];if(a){if(d.cfg&&d.cfg.buttonText){b=b|Math.pow(2,Ext.Array.indexOf(d.buttonIds,e))}if(a.text!=c[e]){a.setText(c[e])}}}}return b},show:function(a){var c=this,b;if(Ext.AbstractComponent.layoutSuspendCount){Ext.on({resumelayouts:function(){c.show(a)},single:true});return c}c.reconfigure(a);if(a.cls){c.addCls(a.cls)}b=c.query("textfield:not([hidden]),textarea:not([hidden]),button:not([hidden])");c.preventFocusOnActivate=!b.length;c.hidden=true;c.callParent();return c},onShow:function(){this.callParent(arguments);this.center()},updateText:function(a){this.msg.setValue(a)},setIcon:function(d,c,a){var e=this,f=e.iconComponent,b=e.messageIconCls;if(b){f.removeCls(b)}if(d){f.show();f.setSize(c||e.iconWidth,a||e.iconHeight);f.addCls(Ext.baseCSSPrefix+"dlg-icon");f.addCls(e.messageIconCls=d)}else{f.removeCls(Ext.baseCSSPrefix+"dlg-icon");f.hide()}return e},updateProgress:function(b,a,c){this.progressBar.updateProgress(b,a);if(c){this.updateText(c)}return this},onEsc:function(){if(this.closable!==false){this.callParent(arguments)}},confirm:function(a,d,c,b){if(Ext.isString(a)){a={title:a,icon:this.QUESTION,msg:d,buttons:this.YESNO,callback:c,scope:b}}return this.show(a)},prompt:function(b,f,d,c,a,e){if(Ext.isString(b)){b={prompt:true,title:b,minWidth:this.minPromptWidth,msg:f,buttons:this.OKCANCEL,callback:d,scope:c,multiline:a,value:e}}return this.show(b)},wait:function(a,c,b){if(Ext.isString(a)){a={title:c,msg:a,closable:false,wait:true,modal:true,minWidth:this.minProgressWidth,waitConfig:b}}return this.show(a)},alert:function(a,d,c,b){if(Ext.isString(a)){a={title:a,msg:d,buttons:this.OK,fn:c,scope:b,minWidth:this.minWidth}}return this.show(a)},progress:function(a,c,b){if(Ext.isString(a)){a={title:a,msg:c,progress:true,progressText:b}}return this.show(a)}},function(){Ext.MessageBox=Ext.Msg=new this()});