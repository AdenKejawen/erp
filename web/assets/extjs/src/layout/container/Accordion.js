Ext.define("Ext.layout.container.Accordion",{extend:"Ext.layout.container.VBox",alias:["layout.accordion"],alternateClassName:"Ext.layout.AccordionLayout",targetCls:Ext.baseCSSPrefix+"accordion-layout-ct",itemCls:[Ext.baseCSSPrefix+"box-item",Ext.baseCSSPrefix+"accordion-item"],align:"stretch",fill:true,titleCollapse:true,hideCollapseTool:false,collapseFirst:undefined,animate:true,activeOnTop:false,multi:false,defaultAnimatePolicy:{y:true,height:true},constructor:function(){var a=this;a.callParent(arguments);if(!a.multi&&a.animate){a.animatePolicy=Ext.apply({},a.defaultAnimatePolicy)}else{a.animatePolicy=null}},beforeRenderItems:function(g){var h=this,f=g.length,c=0,b=h.owner,j=h.collapseFirst,a=Ext.isDefined(j),k=h.getExpanded(true)[0],e=h.multi,d;for(;c<f;c++){d=g[c];if(!d.rendered){if(!e||d.collapsible!==false){d.collapsible=true}if(d.collapsible){if(a){d.collapseFirst=j}if(h.hideCollapseTool){d.hideCollapseTool=h.hideCollapseTool;d.titleCollapse=true}else{if(h.titleCollapse&&d.titleCollapse===undefined){d.titleCollapse=h.titleCollapse}}}delete d.hideHeader;delete d.width;d.title=d.title||"&#160;";d.addBodyCls(Ext.baseCSSPrefix+"accordion-body");if(!e){if(k){d.collapsed=k!==d}else{if(d.hasOwnProperty("collapsed")&&d.collapsed===false){k=d}else{d.collapsed=true}}b.mon(d,{show:h.onComponentShow,beforeexpand:h.onComponentExpand,beforecollapse:h.onComponentCollapse,scope:h})}b.mon(d,"beforecollapse",h.onComponentCollapse,h);d.headerOverCls=Ext.baseCSSPrefix+"accordion-hd-over"}}if(!e){if(!k){if(f){g[0].collapsed=false}}else{if(h.activeOnTop){k.collapsed=false;h.configureItem(k);if(b.items.indexOf(k)>0){b.insert(0,k)}}}}},getItemsRenderTree:function(a){this.beforeRenderItems(a);return this.callParent(arguments)},renderItems:function(a,b){this.beforeRenderItems(a);this.callParent(arguments)},configureItem:function(a){this.callParent(arguments);a.animCollapse=a.border=false;if(this.fill){a.flex=1}},beginLayout:function(a){this.callParent(arguments);this.updatePanelClasses(a)},updatePanelClasses:function(e){var c=e.visibleItems,d=c.length,a=true,b,g,f;for(b=0;b<d;b++){g=c[b];f=g.header;f.addCls(Ext.baseCSSPrefix+"accordion-hd");if(a){f.removeCls(Ext.baseCSSPrefix+"accordion-hd-sibling-expanded")}else{f.addCls(Ext.baseCSSPrefix+"accordion-hd-sibling-expanded")}if(b+1==d&&g.collapsed){f.addCls(Ext.baseCSSPrefix+"accordion-hd-last-collapsed")}else{f.removeCls(Ext.baseCSSPrefix+"accordion-hd-last-collapsed")}a=g.collapsed}},onComponentExpand:function(c){var h=this,b=h.owner,f=h.multi,a=h.animate,j=!f&&!h.animate&&h.activeOnTop,g,k,e,d;if(!h.processing){h.processing=true;d=b.deferLayouts;b.deferLayouts=true;g=f?[]:h.getExpanded();k=g.length;for(e=0;e<k;e++){g[e].collapse()}if(j){Ext.suspendLayouts();b.insert(0,c);Ext.resumeLayouts()}b.deferLayouts=d;h.processing=false}},onComponentCollapse:function(d){var e=this,a=e.owner,f,c,b;if(e.owner.items.getCount()===1){return false}if(!e.processing){e.processing=true;b=a.deferLayouts;a.deferLayouts=true;f=d.next()||d.prev();if(e.multi){c=e.getExpanded();if(c.length===1){f.expand()}}else{if(f){f.expand()}}a.deferLayouts=b;e.processing=false}},onComponentShow:function(a){this.onComponentExpand(a)},getExpanded:function(g){var b=this.owner.items.items,a=b.length,d=0,c=[],f,e;for(;d<a;++d){e=b[d];if(g){f=e.hasOwnProperty("collapsed")&&e.collapsed===false}else{f=!e.collapsed}if(f){c.push(e)}}return c}});