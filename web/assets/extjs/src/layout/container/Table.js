Ext.define("Ext.layout.container.Table",{alias:["layout.table"],extend:"Ext.layout.container.Container",alternateClassName:"Ext.layout.TableLayout",monitorResize:false,type:"table",createsInnerCt:true,targetCls:Ext.baseCSSPrefix+"table-layout-ct",tableCls:Ext.baseCSSPrefix+"table-layout",cellCls:Ext.baseCSSPrefix+"table-layout-cell",tableAttrs:null,getItemSizePolicy:function(a){return this.autoSizePolicy},initHierarchyState:function(a){a.inShrinkWrapTable=true},getLayoutItems:function(){var f=this,b=[],c=f.callParent(),e,a=c.length,d;for(d=0;d<a;d++){e=c[d];if(!e.hidden){b.push(e)}}return b},getHiddenItems:function(){var b=[],c=this.owner.items.items,a=c.length,d=0,e;for(;d<a;++d){e=c[d];if(e.rendered&&e.hidden){b.push(e)}}return b},renderChildren:function(){var k=this,j=k.getLayoutItems(),g=k.owner.getTargetEl().child("table",true).tBodies[0],q=g.rows,f=0,h=j.length,e=k.getHiddenItems(),p,n,c,a,o,m,l,b,d;p=k.calculateCells(j);for(;f<h;f++){n=p[f];c=n.rowIdx;a=n.cellIdx;o=j[f];m=q[c];if(!m){m=g.insertRow(c);if(k.trAttrs){m.set(k.trAttrs)}}b=l=Ext.get(m.cells[a]||m.insertCell(a));if(k.needsDivWrap()){b=l.first()||l.createChild({tag:"div"});b.setWidth(null)}if(!o.rendered){k.renderItem(o,b,0)}else{if(!k.isValidParent(o,b,c,a,g)){k.moveItem(o,b,0)}}if(k.tdAttrs){l.set(k.tdAttrs)}if(o.tdAttrs){l.set(o.tdAttrs)}l.set({colSpan:o.colspan||1,rowSpan:o.rowspan||1,id:o.cellId||"",cls:k.cellCls+" "+(o.cellCls||"")});if(!p[f+1]||p[f+1].rowIdx!==c){a++;while(m.cells[a]){m.deleteCell(a)}}}c++;while(g.rows[c]){g.deleteRow(c)}for(f=0,h=e.length;f<h;++f){k.ensureInDocument(e[f].getEl())}},ensureInDocument:function(a){var b=a.dom.parentNode;while(b){if(b.tagName.toUpperCase()=="BODY"){return}b=b.parentNode}Ext.getDetachedBody().appendChild(a)},calculate:function(f){if(!f.hasDomProp("containerChildrenSizeDone")){this.done=false}else{var c=f.targetContext,b=f.widthModel.shrinkWrap,a=f.heightModel.shrinkWrap,g=a||b,d=g&&c.el.child("table",true),e=g&&c.getPaddingInfo();if(b){f.setContentWidth(d.offsetWidth+e.width,true)}if(a){f.setContentHeight(d.offsetHeight+e.height,true)}}},finalizeLayout:function(){if(this.needsDivWrap()){var b=this.getLayoutItems(),c,a=b.length,d;for(c=0;c<a;c++){d=b[c];Ext.fly(d.el.dom.parentNode).setWidth(d.getWidth())}}if(Ext.isIE6||Ext.isIEQuirks){this.owner.getTargetEl().child("table").repaint()}},calculateCells:function(h){var l=[],b=0,d=0,a=0,g=this.columns||Infinity,m=[],e=0,c,f=h.length,k;for(;e<f;e++){k=h[e];while(d>=g||m[d]>0){if(d>=g){d=0;a=0;b++;for(c=0;c<g;c++){if(m[c]>0){m[c]--}}}else{d++}}l.push({rowIdx:b,cellIdx:a});for(c=k.colspan||1;c;--c){m[d]=k.rowspan||1;++d}++a}return l},getRenderTree:function(){var j=this,g=j.getLayoutItems(),n,o=[],p=Ext.apply({tag:"table",role:"presentation",cls:j.tableCls,cellspacing:0,cellpadding:0,cn:{tag:"tbody",cn:o}},j.tableAttrs),c=j.tdAttrs,d=j.needsDivWrap(),e,f=g.length,m,l,h,b,a,k;n=j.calculateCells(g);for(e=0;e<f;e++){m=g[e];l=n[e];b=l.rowIdx;a=l.cellIdx;h=o[b];if(!h){h=o[b]={tag:"tr",cn:[]};if(j.trAttrs){Ext.apply(h,j.trAttrs)}}k=h.cn[a]={tag:"td"};if(c){Ext.apply(k,c)}Ext.apply(k,{colSpan:m.colspan||1,rowSpan:m.rowspan||1,id:m.cellId||"",cls:j.cellCls+" "+(m.cellCls||"")});if(d){k=k.cn={tag:"div"}}j.configureItem(m);k.cn=m.getRenderTree()}return p},isValidParent:function(f,g,e,d){var b,a,c;if(arguments.length===3){c=f.el.up("table");return c&&c.dom.parentNode===g.dom}b=this.owner.getTargetEl().child("table",true).tBodies[0];a=b.rows[e].cells[d];return f.el.dom.parentNode===a},needsDivWrap:function(){return Ext.isOpera10_5}});