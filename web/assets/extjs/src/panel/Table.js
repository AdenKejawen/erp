Ext.define("Ext.panel.Table",{extend:"Ext.panel.Panel",alias:"widget.tablepanel",uses:["Ext.selection.RowModel","Ext.selection.CellModel","Ext.selection.CheckboxModel","Ext.grid.plugin.BufferedRenderer","Ext.grid.header.Container","Ext.grid.Lockable"],extraBaseCls:Ext.baseCSSPrefix+"grid",extraBodyCls:Ext.baseCSSPrefix+"grid-body",layout:"fit",hasView:false,viewType:null,selType:"rowmodel",scroll:true,deferRowRender:true,sortableColumns:true,enableLocking:false,scrollerOwner:true,enableColumnMove:true,sealedColumns:false,enableColumnResize:true,rowLines:true,colLinesCls:Ext.baseCSSPrefix+"grid-with-col-lines",rowLinesCls:Ext.baseCSSPrefix+"grid-with-row-lines",hiddenHeaderCtCls:Ext.baseCSSPrefix+"grid-header-ct-hidden",hiddenHeaderCls:Ext.baseCSSPrefix+"grid-header-hidden",resizeMarkerCls:Ext.baseCSSPrefix+"grid-resize-marker",emptyCls:Ext.baseCSSPrefix+"grid-empty",initComponent:function(){if(!this.viewType){Ext.Error.raise("You must specify a viewType config.")}if(this.headers){Ext.Error.raise("The headers config is not supported. Please specify columns instead.")}var f=this,g=f.columns||f.colModel,b,d=f.border,e,a,c=f.store=Ext.data.StoreManager.lookup(f.store||"ext-empty-store");if(f.columnLines){f.addCls(f.colLinesCls)}if(f.rowLines){f.addCls(f.rowLinesCls)}if(!g){Ext.Error.raise("A column configuration must be specified")}if(g instanceof Ext.grid.header.Container){f.headerCt=g;f.headerCt.border=d;f.columns=f.headerCt.items.items}else{if(Ext.isArray(g)){g={items:g,border:d}}Ext.apply(g,{forceFit:f.forceFit,sortable:f.sortableColumns,enableColumnMove:f.enableColumnMove,enableColumnResize:f.enableColumnResize,border:d,sealed:f.sealedColumns});if(Ext.isDefined(f.enableColumnHide)){g.enableColumnHide=f.enableColumnHide}f.columns=g.items;if(f.enableLocking||f.hasLockedColumns(f.columns)){f.self.mixin("lockable",Ext.grid.Lockable);f.injectLockable()}}f.scrollTask=new Ext.util.DelayedTask(f.syncHorizontalScroll,f);f.addEvents("reconfigure","viewready");f.bodyCls=f.bodyCls||"";f.bodyCls+=(" "+f.extraBodyCls);f.cls=f.cls||"";f.cls+=(" "+f.extraBaseCls);delete f.autoScroll;if(!f.hasView){if(!f.headerCt){f.headerCt=new Ext.grid.header.Container(g)}f.columns=f.headerCt.items.items;if(c.buffered&&!c.remoteSort){for(e=0,a=f.columns.length;e<a;e++){f.columns[e].sortable=false}}if(f.hideHeaders){f.headerCt.height=0;f.headerCt.hiddenHeaders=true;f.headerCt.addCls(f.hiddenHeaderCtCls);f.addCls(f.hiddenHeaderCls);if(Ext.isIEQuirks){f.headerCt.style={display:"none"}}}f.relayHeaderCtEvents(f.headerCt);f.features=f.features||[];if(!Ext.isArray(f.features)){f.features=[f.features]}f.dockedItems=[].concat(f.dockedItems||[]);f.dockedItems.unshift(f.headerCt);f.viewConfig=f.viewConfig||{};b=f.getView();f.items=[b];f.hasView=true;if(!f.hideHeaders){b.on({scroll:{fn:f.onHorizontalScroll,element:"el",scope:f}})}f.bindStore(c);f.mon(b,{viewready:f.onViewReady,refresh:f.onRestoreHorzScroll,scope:f})}this.relayEvents(f.view,["beforeitemmousedown","beforeitemmouseup","beforeitemmouseenter","beforeitemmouseleave","beforeitemclick","beforeitemdblclick","beforeitemcontextmenu","itemmousedown","itemmouseup","itemmouseenter","itemmouseleave","itemclick","itemdblclick","itemcontextmenu","beforecellclick","cellclick","beforecelldblclick","celldblclick","beforecellcontextmenu","cellcontextmenu","beforecellmousedown","cellmousedown","beforecellmouseup","cellmouseup","beforecellkeydown","cellkeydown","beforecontainermousedown","beforecontainermouseup","beforecontainermouseover","beforecontainermouseout","beforecontainerclick","beforecontainerdblclick","beforecontainercontextmenu","containermouseup","containermouseover","containermouseout","containerclick","containerdblclick","containercontextmenu","selectionchange","beforeselect","select","beforedeselect","deselect"]);f.callParent(arguments);f.addStateEvents(["columnresize","columnmove","columnhide","columnshow","sortchange"]);if(f.headerCt){f.headerCt.on("afterlayout",f.onRestoreHorzScroll,f)}},hasLockedColumns:function(c){var b,a=c.length,d;for(b=0;b<a;b++){d=c[b];if(!d.processed&&d.locked){return true}}},relayHeaderCtEvents:function(a){this.relayEvents(a,["columnresize","columnmove","columnhide","columnshow","columnschanged","sortchange","headerclick","headercontextmenu","headertriggerclick"])},getState:function(){var a=this,b=a.callParent(),c=a.store.sorters.first();b=a.addPropertyToState(b,"columns",(a.headerCt||a).getColumnsState());if(c){b=a.addPropertyToState(b,"sort",{property:c.property,direction:c.direction,root:c.root})}return b},applyState:function(d){var c=this,e=d.sort,a=c.store,b=d.columns;delete d.columns;c.callParent(arguments);if(b){(c.headerCt||c).applyColumnsState(b)}if(e){if(a.remoteSort){a.sort({property:e.property,direction:e.direction,root:e.root},null,false)}else{a.sort(e.property,e.direction)}}},getStore:function(){return this.store},getView:function(){var a=this,b;if(!a.view){b=a.getSelectionModel();Ext.widget(Ext.apply({grid:a,deferInitialRefresh:a.deferRowRender!==false,trackOver:!(a.trackMouseOver===false),scroll:a.scroll,xtype:a.viewType,store:a.store,headerCt:a.headerCt,selModel:b,features:a.features,panel:a,emptyText:a.emptyText||""},a.viewConfig));if(a.view.emptyText){a.view.emptyText='<div class="'+a.emptyCls+'">'+a.view.emptyText+"</div>"}a.view.getComponentLayout().headerCt=a.headerCt;a.mon(a.view,{uievent:a.processEvent,scope:a});b.view=a.view;a.headerCt.view=a.view}return a.view},setAutoScroll:Ext.emptyFn,processEvent:function(f,b,a,c,d,h){var g=this,i;if(d!==-1){i=g.headerCt.getGridColumns()[d];return i.processEvent.apply(i,arguments)}},determineScrollbars:function(){Ext.log.warn("Obsolete")},invalidateScroller:function(){Ext.log.warn("Obsolete")},scrollByDeltaY:function(b,a){this.getView().scrollBy(0,b,a)},scrollByDeltaX:function(b,a){this.getView().scrollBy(b,0,a)},afterCollapse:function(){var a=this;a.saveScrollPos();a.saveScrollPos();a.callParent(arguments)},afterExpand:function(){var a=this;a.callParent(arguments);a.restoreScrollPos();a.restoreScrollPos()},saveScrollPos:Ext.emptyFn,restoreScrollPos:Ext.emptyFn,onHeaderResize:function(){this.delayScroll()},onHeaderMove:function(e,f,a,b,d){var c=this;if(c.optimizedColumnMove===false){c.view.refresh()}else{c.view.moveColumn(b,d,a)}c.delayScroll()},onHeaderHide:function(a,b){this.delayScroll()},onHeaderShow:function(a,b){this.delayScroll()},delayScroll:function(){var a=this.getScrollTarget().el;if(a){this.scrollTask.delay(10,null,null,[a.dom.scrollLeft])}},onViewReady:function(){this.fireEvent("viewready",this)},onRestoreHorzScroll:function(){var a=this.scrollLeftPos;if(a){this.syncHorizontalScroll(a,true)}},getScrollerOwner:function(){var a=this;if(!this.scrollerOwner){a=this.up("[scrollerOwner]")}return a},getLhsMarker:function(){var a=this;return a.lhsMarker||(a.lhsMarker=Ext.DomHelper.append(a.el,{cls:a.resizeMarkerCls},true))},getRhsMarker:function(){var a=this;return a.rhsMarker||(a.rhsMarker=Ext.DomHelper.append(a.el,{cls:a.resizeMarkerCls},true))},getSelectionModel:function(){if(!this.selModel){this.selModel={}}var b="SINGLE",a;if(this.simpleSelect){b="SIMPLE"}else{if(this.multiSelect){b="MULTI"}}Ext.applyIf(this.selModel,{allowDeselect:this.allowDeselect,mode:b});if(!this.selModel.events){a=this.selModel.selType||this.selType;this.selModel=Ext.create("selection."+a,this.selModel)}if(!this.selModel.hasRelaySetup){this.relayEvents(this.selModel,["selectionchange","beforeselect","beforedeselect","select","deselect"]);this.selModel.hasRelaySetup=true}if(this.disableSelection){this.selModel.locked=true}return this.selModel},getScrollTarget:function(){var a=this.getScrollerOwner(),b=a.query("tableview");return b[1]||b[0]},onHorizontalScroll:function(a,b){this.syncHorizontalScroll(b.scrollLeft)},syncHorizontalScroll:function(d,b){var c=this,a;b=b===true;if(c.rendered&&(b||d!==c.scrollLeftPos)){if(b){a=c.getScrollTarget();a.el.dom.scrollLeft=d}c.headerCt.el.dom.scrollLeft=d;c.scrollLeftPos=d}},onStoreLoad:Ext.emptyFn,getEditorParent:function(){return this.body},bindStore:function(b){var c=this,a=c.getView(),d=b&&b.buffered,e;c.store=b;if(a.store!==b){a.bindStore(b,false,"dataSource")}c.mon(b,{load:c.onStoreLoad,scope:c});e=c.findPlugin("bufferedrenderer");if(e){if(e.store){e.bindStore(b)}}else{if(d){c.verticalScroller=e=c.addPlugin(Ext.apply({ptype:"bufferedrenderer"},c.initialConfig.verticalScroller))}}if(e){c.invalidateScrollerOnRefresh=false}if(c.invalidateScrollerOnRefresh!==undefined){a.preserveScrollOnRefresh=!c.invalidateScrollerOnRefresh}},unbindStore:function(){var b=this,a=b.store;if(a){delete b.store;b.mun(a,{load:b.onStoreLoad,scope:b})}},reconfigure:function(b,e){var f=this,a=f.getView(),d,h=f.store,g=f.headerCt,c=g?g.items.getRange():f.columns;if(e){e=Ext.Array.slice(e);delete a.tpl}f.fireEvent("beforereconfigure",f,b,e,h,c);if(f.lockable){f.reconfigureLockable(b,e)}else{Ext.suspendLayouts();if(e){delete f.scrollLeftPos;g.removeAll();g.add(e)}if(b&&b!==h){if(f.store){f.unbindStore()}b=Ext.StoreManager.lookup(b);d=a.deferInitialRefresh;a.deferInitialRefresh=false;f.bindStore(b);a.deferInitialRefresh=d}else{f.getView().refresh()}g.setSortState();Ext.resumeLayouts(true)}f.fireEvent("reconfigure",f,b,e,h,c)}});