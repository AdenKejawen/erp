Ext.define("Ext.ux.dd.CellFieldDropZone",{extend:"Ext.dd.DropZone",constructor:function(a){a=a||{};if(a.onCellDrop){this.onCellDrop=a.onCellDrop}if(a.ddGroup){this.ddGroup=a.ddGroup}},init:function(a){var b=this;if(a.rendered){b.grid=a;a.getView().on({render:function(c){b.view=c;Ext.ux.dd.CellFieldDropZone.superclass.constructor.call(b,b.view.el)},single:true})}else{a.on("render",b.init,b,{single:true})}},containerScroll:true,getTargetFromEvent:function(f){var d=this,b=d.view;var a=f.getTarget(b.getCellSelector());if(a){var g=b.findItemByChild(a),c=a.cellIndex;if(g&&Ext.isDefined(c)){return{node:a,record:b.getRecord(g),fieldName:d.grid.columns[c].dataIndex}}}},onNodeEnter:function(i,a,h,g){delete this.dropOK;if(!i){return}var d=g.field;if(!d){return}var c=i.record.fields.get(i.fieldName).type,b=Ext.data.Types;switch(c){case b.FLOAT:case b.INT:if(!d.isXType("numberfield")){return}break;case b.DATE:if(!d.isXType("datefield")){return}break;case b.BOOL:if(!d.isXType("checkbox")){return}}this.dropOK=true;Ext.fly(i.node).addCls("x-drop-target-active")},onNodeOver:function(d,a,c,b){return this.dropOK?this.dropAllowed:this.dropNotAllowed},onNodeOut:function(d,a,c,b){Ext.fly(d.node).removeCls("x-drop-target-active")},onNodeDrop:function(f,a,d,c){if(this.dropOK){var b=c.field.getValue();f.record.set(f.fieldName,b);this.onCellDrop(f.fieldName,b);return true}},onCellDrop:Ext.emptyFn});